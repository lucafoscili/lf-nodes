import{L as rn,a as lr,b as cr,g as fr,m as dr,C as Sa,c as gt,G as ur,d as hr,e as pr,f as mt,h as Fa,T as gr,i as mr}from"./theme.constants-7kSb6kn5.js";import{L as Da}from"./effects.constants-qYuHpqrU.js";import{_ as yr}from"./preload-helper-C1FmrZbK.js";import{api as X}from"/scripts/api.js";import{app as pe}from"/scripts/app.js";const Aa={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var br=Object.defineProperty,wr=(e,a)=>{for(var t in a)br(e,t,{get:a[t],enumerable:!0})},vr=typeof window<"u"?window:{},on={$resourcesUrl$:""},Lr=e=>{const a=new URL(e,on.$resourcesUrl$);return a.origin!==vr.location.origin?a.href:a.pathname},Sr=e=>on.$resourcesUrl$=e,$r=e=>(e=typeof e,e==="object"||e==="function"),_r={};wr(_r,{err:()=>ln,map:()=>kr,ok:()=>Fs,unwrap:()=>Er,unwrapErr:()=>Cr});var Fs=e=>({isOk:!0,isErr:!1,value:e}),ln=e=>({isOk:!1,isErr:!0,value:e});function kr(e,a){if(e.isOk){const t=a(e.value);return t instanceof Promise?t.then(s=>Fs(s)):Fs(t)}if(e.isErr){const t=e.value;return ln(t)}throw"should never get here"}var Er=e=>{if(e.isOk)return e.value;throw e.value},Cr=e=>{if(e.isErr)return e.value;throw e.value},$s=(e,a,...t)=>{let s=null,n=!1,r=!1;const i=[],o=c=>{for(let f=0;f<c.length;f++)s=c[f],Array.isArray(s)?o(s):s!=null&&typeof s!="boolean"&&((n=typeof e!="function"&&!$r(s))&&(s=String(s)),n&&r?i[i.length-1].$text$+=s:i.push(n?xa(null,s):s),r=n)};o(t);const l=xa(e,null);return l.$attrs$=a,i.length>0&&(l.$children$=i),l},xa=(e,a)=>({$flags$:0,$tag$:e,$text$:a,$elm$:null,$children$:null}),Tr=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},yt=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},Pe,Ds;class Fr{constructor(a){Pe.set(this,void 0),Ds.set(this,t=>{const{logs:s}=yt(this,Pe,"f").debug,{variables:n}=yt(this,Pe,"f").theme.get.current();t==="transparent"&&(t=n["--lf-color-bg"],s.new(this,"Received TRANSPARENT color, converted to "+t+" (theme background)."));const r=/R(\d{1,3})G(\d{1,3})B(\d{1,3})/;if(r.test(t)){const o=t.match(r);t="rgb("+o[1]+","+o[2]+","+o[3]+")"}return t}),this.autoContrast=t=>{const n=this.compute(t).rgbColor.replace(/[^\d,.]/g,"").split(",");return Math.round((Number(n[0])*299+Number(n[1])*587+Number(n[2])*114)/1e3)>125?"#000000":"#ffffff"},this.compute=t=>{const{logs:s}=yt(this,Pe,"f").debug;t=yt(this,Ds,"f").call(this,t);const n=t.toLowerCase();let r=n.startsWith("#");const i=n.startsWith("hsl(")||n.startsWith("hsla("),o=n.startsWith("rgb(")||n.startsWith("rgba(");if(!r&&!i&&!o){const f=this.convert.codeToHex(t);f.startsWith("#")&&(t=f,r=!0)}let l={hexColor:"#000000",hslColor:"hsl(0,0%,0%)",hslValues:"0,0%,0%",hue:"0",saturation:"0%",lightness:"0%",rgbColor:"rgb(0,0,0)",rgbValues:"0,0,0"};if(r||i){const f=t;let d=null;if(r)l.hexColor=t,d=this.convert.hexToRgb(t);else{l.hslColor=t;const u=/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?%)\s*,\s*(\d+(?:\.\d+)?%)/i,p=t.match(u);if(p){const[m,b,v,w]=p;l.hslValues=`${b},${v},${w}`,l.hue=b,l.saturation=v,l.lightness=w;const _=parseFloat(b.replace("deg","")),F=parseFloat(v.replace("%",""))/100,T=parseFloat(w.replace("%",""))/100;d=this.convert.hslToRgb(_,F,T)}else s.new(this,`Invalid HSL(A) color: ${t}. Using defaults.`)}if(d){const{r:u,g:p,b:m}=d,b=`rgb(${u},${p},${m})`;if(l.rgbColor=b,l.rgbValues=`${u},${p},${m}`,r){const{h:v,s:w,l:_}=this.convert.rgbToHsl(u,p,m),F=`${v},${w}%,${_}%`;l.hue=`${v}`,l.saturation=`${w}%`,l.lightness=`${_}%`,l.hslValues=F,l.hslColor=`hsl(${F})`}else l.hexColor=this.convert.rgbToHex(u,p,m);s.new(this,`Received color "${f}" â†’ Final RGB: ${l.rgbColor}.`)}}const c=t.match(/rgba?\((\d{1,3}),\s?(\d{1,3}),\s?(\d{1,3})(?:,\s?[\d.]+)?\)/i);if(c){const[f,d,u,p]=c;if(l.rgbValues=`${d},${u},${p}`,l.rgbColor=`rgb(${d},${u},${p})`,!l.hexColor||l.hexColor==="#000000")try{const m=parseInt(d,10),b=parseInt(u,10),v=parseInt(p,10);l.hexColor=this.convert.rgbToHex(m,b,v)}catch{s.new(this,`Color not converted to hex value: ${t}.`)}if(!l.hslColor||l.hslColor==="hsl(0,0%,0%)")try{const m=parseInt(d,10),b=parseInt(u,10),v=parseInt(p,10),{h:w,s:_,l:F}=this.convert.rgbToHsl(m,b,v),T=`${w},${_}%,${F}%`;l.hue=`${w}`,l.saturation=`${_}%`,l.lightness=`${F}%`,l.hslValues=T,l.hslColor=`hsl(${T})`}catch{s.new(this,`Color not converted to HSL value: ${t}.`)}}else s.new(this,`Color not converted to RGB values: ${t}.`);return l},this.convert={hexToRgb:t=>{var s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return s?{r:parseInt(s[1],16),g:parseInt(s[2],16),b:parseInt(s[3],16)}:null},hslToRgb:(t,s,n)=>{if(t==null)return{r:0,g:0,b:0};let r=t/60;const i=(1-Math.abs(2*n-1))*s,o=i*(1-Math.abs(r%2-1));r=Math.floor(r);let l,c,f;r===0?(l=i,c=o,f=0):r===1?(l=o,c=i,f=0):r===2?(l=0,c=i,f=o):r===3?(l=0,c=o,f=i):r===4?(l=o,c=0,f=i):r===5&&(l=i,c=0,f=o);const d=n-i/2;return l+=d,c+=d,f+=d,{r:Math.round(l*255),g:Math.round(c*255),b:Math.round(f*255)}},rgbToHex:(t,s,n)=>{const{valueToHex:r}=this.convert;return`#${r(t)}${r(s)}${r(n)}`},rgbToHsl:(t,s,n)=>{t/=255,s/=255,n/=255;const r=Math.min(t,s,n),i=Math.max(t,s,n),o=i-r;let l=0,c=0,f=0;return o==0?l=0:i==t?l=(s-n)/o%6:i==s?l=(n-t)/o+2:l=(t-s)/o+4,l=Math.round(l*60),l<0&&(l+=360),f=(i+r)/2,c=o==0?0:o/(1-Math.abs(2*f-1)),c=+(c*100).toFixed(1),f=+(f*100).toFixed(1),{h:l,s:c,l:f}},valueToHex:t=>{const s=t.toString(16);return s.length==1?"0"+s:s},codeToHex:t=>{const{logs:s}=yt(this,Pe,"f").debug,n=t.toLowerCase();return Aa[n]?Aa[n]:(s.new(this,"Could not decode color "+t+"!"),t)}},this.random=t=>{function s(n){var r=255-n,i=0|Math.random()*r+n,o=i.toString(16);return o.length==1?"0"+o:o}return`#${s(t)+s(t)+s(t)}`},Tr(this,Pe,a,"f")}}Pe=new WeakMap,Ds=new WeakMap;const Ia=(e,a)=>{function t(s){for(const n of s){if(n.cells){for(const r in n.cells)if(n.cells[r]===a)return n}if(n.children){const r=t(n.children);if(r)return r}}return null}return t(e.nodes)},cn=e=>{var a;return!!(e&&((a=e.nodes)!=null&&a.length))},Dr=(e,a,t=!1)=>{const s=new Set,n=new Set,r=new Set,i=(o,l,c)=>{var u;const f=(u=o.children)==null?void 0:u.length;let d=!1;for(const p in a){const m=p,b=o[m],v=a[m],w=As(b).toLowerCase(),_=As(v).toLowerCase();if(t){if(!w.includes(_))continue}else if(b!==v)continue;d=!0;break}l&&c.add(l),d?s.add(o):n.add(o),f?o.children.forEach(p=>{i(p,o,c)}):d&&c.forEach(p=>{r.add(p)})};return e.nodes.forEach(o=>{i(o,null,new Set)}),{matchingNodes:s,remainingNodes:n,ancestorNodes:r}},Ar=e=>{function a(t,s="0"){t.id=s,t.children&&t.children.forEach((n,r)=>{const i=`${s}.${r}`;a(n,i)})}return e.forEach(t=>{a(t,"0")}),e},xr=e=>{let a=0,t=0;const s=function(r){return r.children&&r.children.forEach(function(o){s(o)}),0},n=r=>{t++;for(let i=0;i<r.length;i++){const o=r[i];s(o),Array.isArray(o.children)&&a<o.children.length&&(a=o.children.length,n(o.children))}};return n(e),{maxChildren:a,maxDepth:t}},Ir=(e,a)=>{let t=null;for(let s=0;s<e.length;s++){let r=function(i){const o=!!i.children;if(o&&i.children.includes(a)){t=i;return}for(let l=0;!t&&o&&l<i.children.length;l++)r(i.children[l])};const n=e[s];r(n)}return t},Pr=(e,a)=>{let t=null;for(let s=0;s<e.length;s++){let n=function(r,i){const o=i.indexOf(a);if(o>-1){t={...a},i.splice(o,1);return}for(let l=0;r.children&&l<r.children.length;l++)r.children[l]&&n(r.children[l],r.children)};n(e[s],e)}return t},Or=(e,a,t,s)=>{const n=[];s||(s=[]),t&&(e=fn(e));for(let r=0;r<e.length;r++){const i=e[r];for(const o in a)s.includes(i)||(i[o]=a[o],n.push(i))}return n},fn=e=>{function a(s){t.push(s);for(let n=0;s.children&&n<s.children.length;n++)a(s.children[n])}const t=[];for(let s=0;s<e.length;s++){const n=e[s];a(n)}return t},Mr=(e,a,t,s,n,r,i,o)=>{const{data:l,sanitizeProps:c}=e,{stringify:f}=l.cell,d=[];switch(t){case"slot":for(let u=0;s&&u<s.length;u++)d.push($s("slot",{key:`${t}${u}`,name:f(s[u].value)}));break;case"number":case"text":for(let u=0;s&&u<s.length;u++)d.push($s("div",{id:`${t}${u}`,key:`${t}${u}`},s[u].value));break;default:for(let u=0;s&&u<s.length;u++){const p=s[u],m={};r!=null&&r[u]&&Pa(m,r[u]),Pa(m,p);const b="lf-"+t,v={["onLf-"+t+"-event"]:w=>{i&&i(w),n(w)}};d.push($s(b,{"data-component":a,"data-cy":Sa.shape,id:`${t}${u}`,key:`${t}${u}`,ref:w=>{if(w&&Array.isArray(o)&&o[u]){const _=o[u];_(w)}},...v,...c(m,a)}))}break}return d},dn=e=>!!(e&&e.cells&&Object.keys(e.cells).length),un=(e,a)=>{if(!a)return e;const t="lf",s={};for(const n in e)switch(n){case"htmlProps":Object.assign(s,e[n]);break;case"shape":break;default:if(n.indexOf(t)===0)s[n]=e[n];else{const i=t+n.charAt(0).toUpperCase()+n.slice(1);s[i]||(s[i]=e[n])}break}return s},Rr=(e,a=!0)=>{if(!cn(e))return null;const t={badge:[],button:[],canvas:[],card:[],chart:[],chat:[],chip:[],code:[],image:[],number:[],photoframe:[],slot:[],text:[],toggle:[],typewriter:[],upload:[]},s=e.nodes,n=r=>{if(!dn(r))return;const i=r.cells;for(const o in i)if(Object.prototype.hasOwnProperty.call(i,o)){const l=i[o],c=un(l,a);switch(l.shape){case"badge":t.badge.push(c);break;case"button":t.button.push(c);break;case"canvas":t.canvas.push(c);break;case"card":t.card.push(c);break;case"chart":t.chart.push(c);break;case"chat":t.chat.push(c);break;case"chip":t.chip.push(c);break;case"code":t.code.push(c);break;case"image":t.image.push(c);break;case"photoframe":t.photoframe.push(c);break;case"toggle":t.toggle.push(c);break;case"typewriter":t.typewriter.push(c);break;case"number":t.number.push(l);break;case"upload":t.upload.push(c);break;case"slot":t.slot.push(l);break;case"text":default:t.text.push(l);break}}};for(let r=0;r<s.length;r++){const i=s[r];n(i)}return t},As=e=>{if(e==null)return String(e).valueOf();if(e instanceof Date)return e.toISOString();if(typeof e=="object")try{return JSON.stringify(e,null,2)}catch(a){return console.error("Failed to stringify object:",a),"[object Object]"}else return String(e).valueOf()},Pa=(e,a)=>{const t=()=>{e.value&&!e.lfValue?e.lfValue=e.value:e.lfValue&&!e.value&&(e.value=e.lfValue),delete e.htmlProps,delete e.shape,delete e.value};if(a.htmlProps)for(const s in a.htmlProps){const n=a.htmlProps[s];if(s==="className"?e.class=n:e[s]=n,s==="dataset")for(const r in n)e[`data-${r}`]=n[r]}for(const s in a){const r=a[s];e[s]=r}t()},Wr=(e,a)=>{const t=[];if(!e)return t;const s=e.columns?e.columns:e;for(let n=0;n<s.length;n++){const r=s[n];for(const i in a){const o=i,l=a[o];r[o]===l&&t.push(r)}}return t};var Br=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},Oa=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},zt,xs;class Vr{constructor(a){zt.set(this,void 0),xs.set(this,{badge:"LfBadge",button:"LfButton",canvas:"LfCanvas",card:"LfCard",chart:"LfChart",chat:"LfChat",chip:"LfChip",code:"LfCode",image:"LfImage",number:"LfTextfield",photoframe:"LfPhotoframe",slot:"LfTextfield",text:"LfTextfield",toggle:"LfToggle",typewriter:"LfTypewriter",upload:"LfUpload"}),this.cell={exists:t=>dn(t),shapes:{decorate:(t,s,n,r,i,o)=>Mr(Oa(this,zt,"f"),Oa(this,xs,"f")[t],t,s,n,r,i,o),get:(t,s=!0)=>un(t,s),getAll:(t,s=!0)=>Rr(t,s)},stringify:t=>As(t)},this.column={find:(t,s)=>Wr(t,s)},this.node={exists:t=>cn(t),filter:(t,s,n=!1)=>Dr(t,s,n),findNodeByCell:(t,s)=>Ia(t,s),fixIds:t=>Ar(t),getDrilldownInfo:t=>xr(t),getParent:(t,s)=>Ir(t,s),pop:(t,s)=>Pr(t,s),removeNodeByCell:(t,s)=>Ia(t,s),setProperties:(t,s,n,r)=>Or(t,s,n,r),toStream:t=>fn(t)},Br(this,zt,a,"f")}}zt=new WeakMap,xs=new WeakMap;var I=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},_s=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},me,ye,Gt,oe,jt,Is;class Ur{constructor(a){me.set(this,{codes:new Set,toggles:new Set}),ye.set(this,!1),Gt.set(this,250),oe.set(this,[]),jt.set(this,t=>{Array.from(I(this,me,"f").codes).forEach(s=>{t?s.lfValue=`# ${t.id}:
${t.message}

${s.lfValue}`:s.lfValue=""})}),Is.set(this,()=>{Array.from(I(this,me,"f").toggles).forEach(t=>{t.setValue(I(this,ye,"f")?"on":"off")})}),this.info={create:()=>({endTime:0,renderCount:0,renderEnd:0,renderStart:0,startTime:performance.now()}),update:async(t,s)=>{switch(s){case"custom":this.isEnabled()&&this.logs.new(t,"Custom breakpoint  took "+(window.performance.now()-t.debugInfo.renderStart)+"ms.");break;case"did-render":t.debugInfo.renderEnd=window.performance.now(),this.isEnabled()&&this.logs.new(t,"Render #"+t.debugInfo.renderCount+" took "+(t.debugInfo.renderEnd-t.debugInfo.renderStart)+"ms.");break;case"did-load":t.debugInfo.endTime=window.performance.now(),this.logs.new(t,"Component ready after "+(t.debugInfo.endTime-t.debugInfo.startTime)+"ms.");break;case"will-render":t.debugInfo.renderCount++,t.debugInfo.renderStart=window.performance.now();break}}},this.logs={dump:()=>{_s(this,oe,[],"f"),I(this,jt,"f").call(this)},fromComponent(t){return t.rootElement!==void 0},new:async(t,s,n="informational")=>{if(I(this,me,"f").codes.has(t))return;const r=this.logs.fromComponent(t),i={category:n,class:null,date:new Date,id:r?`${t.rootElement.tagName} ${t.rootElement.id?"( #"+t.rootElement.id+" )":""}`:"LfFramework",message:s,type:s.indexOf("Render #")>-1?"render":s.indexOf("Component ready")>-1?"load":s.indexOf("Size changed")>-1?"resize":"misc"};switch(I(this,oe,"f").length>I(this,Gt,"f")&&(I(this,ye,"f")&&console.warn(i.date.toLocaleDateString()+" lf-debug => Too many logs (> "+I(this,Gt,"f")+")! Dumping (increase debug.logLimit to store more logs)... ."),this.logs.dump()),I(this,oe,"f").push(i),n){case"error":console.error(`${i.date.toLocaleDateString()} ${i.id} ${i.message}`,i.class);break;case"warning":console.warn(`${i.date.toLocaleDateString()} ${i.id} ${i.message}`,i.class);break}this.isEnabled()&&I(this,jt,"f").call(this,i)},print:()=>{const t={load:[],misc:[],render:[],resize:[]};for(let s=0;s<I(this,oe,"f").length;s++){const n=I(this,oe,"f")[s],r={class:n.class,date:n.date.toLocaleDateString(),message:n.id+n.message};t[n.type].push(r)}for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const n=s,r=t[n];console.groupCollapsed("%c  %c"+s+" logs ("+t[n].length+")","background-color: green; margin-right: 10px; border-radius: 50%","background-color: transparent");for(let i=0;i<r.length;i++){const o=r[i];console.log(o.date,o.message,o.class)}console.groupEnd()}I(this,oe,"f").length>0&&(console.groupCollapsed("%c  %cAll logs ("+I(this,oe,"f").length+")","background-color: blue; margin-right: 10px; border-radius: 50%","background-color: transparent"),console.table(I(this,oe,"f")),console.groupEnd())}},this.isEnabled=()=>I(this,ye,"f"),this.register=t=>{t.rootElement.tagName.toLowerCase()==="lf-code"?I(this,me,"f").codes.add(t):I(this,me,"f").toggles.add(t)},this.toggle=(t,s=!0)=>(t===!1||t===!0?_s(this,ye,t,"f"):_s(this,ye,!I(this,ye,"f"),"f"),s&&I(this,Is,"f").call(this),I(this,ye,"f")),this.unregister=t=>{t.rootElement.tagName.toLowerCase()==="lf-code"?I(this,me,"f").codes.delete(t):I(this,me,"f").toggles.delete(t)}}}me=new WeakMap,ye=new WeakMap,Gt=new WeakMap,oe=new WeakMap,jt=new WeakMap,Is=new WeakMap;var Oe=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},E=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},Fe,Qe,Ps,Me,Ne,Os,O,et,Ms,Ma,Rs,Ws,Bs,Vs;class zr{constructor(a){Fe.add(this),Qe.set(this,!1),Ps.set(this,5),Me.set(this,void 0),Ne.set(this,null),Os.set(this,window.matchMedia("(prefers-reduced-motion: reduce)").matches),O.set(this,new WeakMap),Ms.set(this,(t,s)=>{const n=i=>{var o,l;(l=(o=s.callbacks)==null?void 0:o.onMove)==null||l.call(o,i,s)},r=i=>{var o,l;t.removeEventListener("pointermove",n),t.removeEventListener("pointerup",r),t.removeEventListener("pointercancel",r),(l=(o=s.callbacks)==null?void 0:o.onEnd)==null||l.call(o,i,s)};t.addEventListener("pointermove",n),t.addEventListener("pointerup",r),t.addEventListener("pointercancel",r)}),Rs.set(this,(t,s)=>{var u,p;const n=E(this,O,"f").get(t);if(!n){E(this,Me,"f").debug.logs.new(this,"Attempted to interact with an unregistered element.","warning");return}const r=s.clientX,i=s.clientY,o=t.getBoundingClientRect(),l=o.left,c=o.top;(p=(u=n.callbacks)==null?void 0:u.onStart)==null||p.call(u,s,n),t.style.position="absolute",t.style.cursor="grabbing";const f=m=>{var w,_;n.dragData={...n.dragData,startX:r,startY:i,deltaX:m.clientX-r,deltaY:m.clientY-i,lastX:m.clientX,lastY:m.clientY,lastScrollLeft:0,lastScrollTop:0,startScrollLeft:0,startScrollTop:0};const b=l+n.dragData.deltaX,v=c+n.dragData.deltaY;t.style.left=`${b}px`,t.style.top=`${v}px`,(_=(w=n.callbacks)==null?void 0:w.onMove)==null||_.call(w,m,n)},d=m=>{var b,v;t.removeEventListener("pointermove",f),t.removeEventListener("pointerup",d),t.removeEventListener("pointercancel",d),t.style.cursor="auto",(v=(b=n.callbacks)==null?void 0:b.onEnd)==null||v.call(b,m,n)};t.addEventListener("pointermove",f),t.addEventListener("pointerup",d),t.addEventListener("pointercancel",d)}),Ws.set(this,(t,s)=>{var d,u;const n=E(this,O,"f").get(t);if(!n){E(this,Me,"f").debug.logs.new(this,"Attempted to interact with an unregistered element.","warning");return}const r=t.offsetWidth,i=t.offsetHeight,o=s.clientX,l=s.clientY;(u=(d=n.callbacks)==null?void 0:d.onStart)==null||u.call(d,s,n),t.style.cursor="nwse-resize";const c=p=>{var v,w;const m=p.clientX-o,b=p.clientY-l;n.dragData={...n.dragData,startX:o,startY:l,deltaX:m,deltaY:b,lastX:p.clientX,lastY:p.clientY,startScrollLeft:0,startScrollTop:0,lastScrollLeft:0,lastScrollTop:0},t.style.width=`${r+m}px`,t.style.height=`${i+b}px`,(w=(v=n.callbacks)==null?void 0:v.onMove)==null||w.call(v,p,n)},f=p=>{var m,b;t.removeEventListener("pointermove",c),t.removeEventListener("pointerup",f),t.removeEventListener("pointercancel",f),t.style.cursor="auto",(b=(m=n.callbacks)==null?void 0:m.onEnd)==null||b.call(m,p,n)};t.addEventListener("pointermove",c),t.addEventListener("pointerup",f),t.addEventListener("pointercancel",f)}),Bs.set(this,(t,s,n="x",r,i)=>{var b,v;const o=E(this,O,"f").get(t);if(!o){E(this,Me,"f").debug.logs.new(this,"Attempted to interact with an unregistered element.","warning");return}t.setPointerCapture(s.pointerId);const l=s.clientX-r,c=s.clientY-i,f=t.scrollLeft,d=t.scrollTop,u=performance.now();(v=(b=o.callbacks)==null?void 0:b.onStart)==null||v.call(b,s,o),t.style.cursor="grabbing",t.style.userSelect="none";const p=w=>{var ae,he,Rt;const _=performance.now(),F=_-(((ae=o.dragData)==null?void 0:ae.lastMoveTime)||u),T=w.clientX-l,j=w.clientY-c;switch(n){case"x":t.scrollLeft=f-T;break;case"y":t.scrollTop=d-j;break}const q=-(T/F),U=-(j/F);o.dragData={startX:l,startY:c,startScrollLeft:f,startScrollTop:d,velocityX:q,velocityY:U,lastMoveTime:_,deltaX:w.clientX-l,deltaY:w.clientY-c,lastX:w.clientX,lastY:w.clientY,lastScrollLeft:t.scrollLeft,lastScrollTop:t.scrollTop},(Rt=(he=o.callbacks)==null?void 0:he.onMove)==null||Rt.call(he,w,o)},m=w=>{var _,F,T,j;if(t.releasePointerCapture(w.pointerId),t.removeEventListener("pointermove",p),t.removeEventListener("pointerup",m),t.removeEventListener("pointercancel",m),!E(this,Os,"f")){let q=((_=o.dragData)==null?void 0:_.velocityX)??0,U=((F=o.dragData)==null?void 0:F.velocityY)??0;const ae=1,he=()=>{if(Math.abs(q)>.1){switch(n){case"x":t.scrollLeft+=q*ae;break;case"y":t.scrollTop+=U*ae;break}q*=.95,U*=.95,requestAnimationFrame(he)}};he()}t.setAttribute("aria-grabbed","false"),(j=(T=o.callbacks)==null?void 0:T.onEnd)==null||j.call(T,w,o)};t.addEventListener("pointermove",p),t.addEventListener("pointerup",m),t.addEventListener("pointercancel",m)}),Vs.set(this,(t,s,n="x")=>{var u,p;const r=E(this,O,"f").get(t);if(!r){E(this,Me,"f").debug.logs.new(this,"Attempted to interact with an unregistered element.","warning");return}const i=50,o=s.clientX,l=s.clientY;r.swipeData||(r.swipeData={direction:null},(p=(u=r.callbacks)==null?void 0:u.onStart)==null||p.call(u,s,r));let c=!1;const f=m=>{var F,T;const b=m.clientX-o,v=m.clientY-l,w=Math.abs(b),_=Math.abs(v);w>_&&w>i&&!c&&m.cancelable&&(m.preventDefault(),c=!0),n==="x"&&w>i?r.swipeData.direction=b>0?"right":"left":n==="y"&&_>i&&(r.swipeData.direction=v>0?"down":"up"),(T=(F=r.callbacks)==null?void 0:F.onMove)==null||T.call(F,m,r)},d=m=>{var b,v,w;t.removeEventListener("pointermove",f),t.removeEventListener("pointerup",d),t.removeEventListener("pointercancel",d),(b=r.swipeData)!=null&&b.direction&&((w=(v=r.callbacks)==null?void 0:v.onEnd)==null||w.call(v,m,r)),r.swipeData=null,c=!1};t.addEventListener("pointermove",f),t.addEventListener("pointerup",d),t.addEventListener("pointercancel",d)}),this.register={customDrag:(t,s,n={})=>{E(this,Fe,"m",et).call(this,t,n,r=>{const i=E(this,O,"f").get(t);if(!i){console.warn("Attempted to interact with an unregistered element.");return}s(r,i),!n.onMove&&!n.onEnd&&E(this,Ms,"f").call(this,t,i)})},dragToDrop:(t,s)=>{E(this,Fe,"m",et).call(this,t,s,n=>{E(this,Rs,"f").call(this,t,n)})},dragToResize:(t,s)=>{E(this,Fe,"m",et).call(this,t,s,n=>{E(this,Ws,"f").call(this,t,n)})},dragToScroll:(t,s,n="x")=>{E(this,Fe,"m",et).call(this,t,s,(r,i,o)=>{E(this,Bs,"f").call(this,t,r,n,i,o)})},swipe:(t,s,n="x")=>{E(this,Fe,"m",et).call(this,t,s,r=>{E(this,Vs,"f").call(this,t,r,n)})}},this.unregister={all:t=>{const s=E(this,O,"f").get(t);s&&(s.cleanupCb(),E(this,O,"f").delete(t))},customDrag:t=>{const s=E(this,O,"f").get(t);s==null||s.cleanupCb(),E(this,O,"f").delete(t)},dragToDrop:t=>{const s=E(this,O,"f").get(t);s==null||s.cleanupCb(),E(this,O,"f").delete(t)},dragToResize:t=>{const s=E(this,O,"f").get(t);s==null||s.cleanupCb(),E(this,O,"f").delete(t)},dragToScroll:t=>{const s=E(this,O,"f").get(t);s==null||s.cleanupCb(),E(this,O,"f").delete(t)},swipe:t=>{const s=E(this,O,"f").get(t);s==null||s.cleanupCb(),E(this,O,"f").delete(t)}},Oe(this,Me,a,"f")}getActiveSession(a){return E(this,O,"f").get(a)}}Qe=new WeakMap,Ps=new WeakMap,Me=new WeakMap,Ne=new WeakMap,Os=new WeakMap,O=new WeakMap,Ms=new WeakMap,Rs=new WeakMap,Ws=new WeakMap,Bs=new WeakMap,Vs=new WeakMap,Fe=new WeakSet,et=function(a,t={},s){var i;(i=E(this,O,"f").get(a))==null||i.cleanupCb(),E(this,O,"f").delete(a);const n=E(this,Fe,"m",Ma).call(this,a,E(this,Ps,"f"),(o,l,c)=>{s(o,l,c)}),r={cleanupCb:()=>{n(),a.style.cursor="auto",a.style.userSelect="auto",a.removeAttribute("aria-grabbed"),delete a.dataset.lf},element:a,callbacks:t,dragData:void 0};E(this,O,"f").set(a,r)},Ma=function(a,t,s){let n=0,r=0;Oe(this,Qe,!1,"f"),Oe(this,Ne,null,"f");const i=c=>{n=c.clientX,r=c.clientY,Oe(this,Qe,!1,"f"),Oe(this,Ne,c.pointerId,"f")},o=c=>{if(E(this,Ne,"f")===null)return;const f=c.clientX-n,d=c.clientY-r,u=Math.sqrt(f**2+d**2);!E(this,Qe,"f")&&u>t&&(Oe(this,Qe,!0,"f"),c.preventDefault(),a.setPointerCapture(c.pointerId),s(c,f,d))},l=c=>{Oe(this,Ne,null,"f")};return a.addEventListener("pointerdown",i),a.addEventListener("pointermove",o),a.addEventListener("pointerup",l),a.addEventListener("pointercancel",l),()=>{a.removeEventListener("pointerdown",i),a.removeEventListener("pointermove",o),a.removeEventListener("pointerup",l),a.removeEventListener("pointercancel",l)}};var Ge=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},P=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},Se,Et,$e,Us,_e,Ct,Ht,Jt,zs;class Gr{constructor(a){Se.set(this,null),Et.set(this,new Set),$e.set(this,void 0),Us.set(this,{tilt:10}),_e.set(this,null),Ct.set(this,void 0),Ht.set(this,{lightbox:300,ripple:500}),Jt.set(this,t=>{typeof document>"u"||(P(this,$e,"f")||(Ge(this,$e,document.createElement("div"),"f"),P(this,$e,"f").classList.add("lf-effects"),P(this,$e,"f").dataset.cy=Sa.effects,document.body.appendChild(P(this,$e,"f"))),P(this,$e,"f").appendChild(t))}),zs.set(this,t=>{const{parentElement:s}=t,{backgroundColor:n,borderRadius:r,color:i}=getComputedStyle(s);return{backgroundColor:n,borderRadius:r,color:i}}),this.set={intensity:(t,s)=>P(this,Us,"f")[t]=s,timeout:(t,s)=>P(this,Ht,"f")[t]=s},this.backdrop={hide:()=>{if(!P(this,Se,"f"))return;const t=P(this,Se,"f");t.style.opacity="0",t.addEventListener("transitionend",()=>{t.remove(),Ge(this,Se,null,"f")})},isVisible:()=>!!P(this,Se,"f"),show:t=>{const{logs:s}=P(this,Ct,"f").debug;if(P(this,Se,"f")){s.new(this,"A modal is already open.","warning");return}const n=document.createElement("div");n.setAttribute("data-lf",gt.backdrop),n.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation()}),n.addEventListener("pointerdown",r=>{r.preventDefault(),r.stopPropagation(),t&&t()}),n.addEventListener("touchstart",r=>{r.preventDefault(),r.stopPropagation()},{passive:!1}),P(this,Jt,"f").call(this,n),requestAnimationFrame(()=>{n.style.opacity="1"}),Ge(this,Se,n,"f")}},this.lightbox={show:async(t,s)=>{const{debug:n}=P(this,Ct,"f");if(P(this,_e,"f")){n.logs.new(this,"Lightbox is already open.","warning");return}const r=t.cloneNode(!0);if(t.tagName.startsWith("LF-")&&"getProps"in t){const c=await t.getProps();Object.assign(r,c)}r.setAttribute("data-lf",gt.lightboxContent),r.setAttribute("role","dialog"),r.setAttribute("aria-modal","true"),r.setAttribute("tabindex","-1");const i=c=>{c.key==="Escape"&&this.lightbox.hide()};r.addEventListener("keydown",i);const o=this.lightbox.hide;this.lightbox.hide=()=>{s&&s(),o.call(this.lightbox),document.removeEventListener("keydown",i),this.lightbox.hide=o};const l=document.createElement("div");l.setAttribute("data-lf",gt.lightbox),l.appendChild(r),P(this,Jt,"f").call(this,l),Ge(this,_e,l,"f"),this.backdrop.show(()=>this.lightbox.hide()),requestAnimationFrame(async()=>{r.focus()})},hide:()=>{P(this,_e,"f")&&(P(this,_e,"f").remove(),Ge(this,_e,null,"f"),this.backdrop.hide())},isVisible:()=>!!P(this,_e,"f")},this.ripple=(t,s,n=!0)=>{if(!s)return;const r=document.createElement("span"),{left:i,height:o,top:l,width:c}=s.getBoundingClientRect(),{backgroundColor:f,borderRadius:d,color:u}=P(this,zs,"f").call(this,s),p=t.clientX-i-c/2,m=t.clientY-l-o/2;n&&(s.style.borderRadius=d);const{background:b,height:v,width:w,x:_,y:F}=Da.ripple;r.dataset.lf=gt.ripple,r.style.setProperty(b,u||f),r.style.setProperty(v,`${o}px`),r.style.setProperty(w,`${c}px`),r.style.setProperty(_,`${p}px`),r.style.setProperty(F,`${m}px`),s.appendChild(r),setTimeout(()=>requestAnimationFrame(async()=>{r.remove()}),P(this,Ht,"f").ripple)},this.isRegistered=t=>P(this,Et,"f").has(t),this.register={tilt:(t,s=10)=>{const{tilt:n}=Da;t.addEventListener("pointermove",r=>{const{clientX:i,clientY:o}=r,{height:l,left:c,top:f,width:d}=t.getBoundingClientRect(),u=(i-c)/d*100,p=(o-f)/l*100;t.style.setProperty(n.x,`${((i-c)/d-.5)*s}deg`),t.style.setProperty(n.y,`${-((o-f)/l-.5)*s}deg`),t.style.setProperty(n.lightX,`${u}%`),t.style.setProperty(n.lightY,`${p}%`)}),t.addEventListener("pointerleave",()=>{t.style.setProperty(n.x,"0deg"),t.style.setProperty(n.y,"0deg"),t.style.setProperty(n.lightX,"50%"),t.style.setProperty(n.lightY,"50%")}),t.dataset.lf=gt.tilt,P(this,Et,"f").add(t)}},this.unregister={tilt:t=>{t.removeEventListener("pointermove",()=>{}),t.removeEventListener("pointerleave",()=>{}),P(this,Et,"f").delete(t)}},Ge(this,Ct,a,"f")}}Se=new WeakMap,Et=new WeakMap,$e=new WeakMap,Us=new WeakMap,_e=new WeakMap,Ct=new WeakMap,Ht=new WeakMap,Jt=new WeakMap,zs=new WeakMap;var jr=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},Hr=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},qt;class Jr{constructor(a){qt.set(this,void 0),this.fetch=async(t,s)=>{try{const n=await fetch(`${s}/v1/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(n){throw console.error("Error calling LLM:",n),n}},this.poll=async t=>fetch(t),this.speechToText=async(t,s)=>{const{debug:n}=Hr(this,qt,"f"),r=window.SpeechRecognition||window.webkitSpeechRecognition;if(!r){alert("Speech recognition is not supported in this browser.");return}const i=new r;i.interimResults=!0,i.maxAlternatives=1,i.addEventListener("result",o=>{const l=Array.from(o.results).map(f=>f[0]).map(f=>f.transcript).join("");n.logs.new(this,"STT response: "+l),t.setValue(l),o.results[o.results.length-1].isFinal&&i.stop()}),i.addEventListener("end",()=>{i.stop(),s.lfShowSpinner=!1}),i.addEventListener("start",()=>{t.setFocus(),s.lfShowSpinner=!0});try{i.start()}catch(o){n.logs.new(this,"Error: "+o,"error")}},jr(this,qt,a,"f")}}qt=new WeakMap;var Ra=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},D=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},ke,tt,Ee,be,Gs,Yt,Xt,js,Hs,Kt;class qr{constructor(a){ke.set(this,{frameId:0,queue:new Set}),tt.set(this,void 0),Ee.set(this,void 0),be.set(this,new WeakMap),Gs.set(this,t=>{typeof document>"u"||(D(this,Ee,"f")||(Ra(this,Ee,document.createElement("div"),"f"),D(this,Ee,"f").classList.add("lf-portal"),D(this,Ee,"f").dataset.cy=Sa.portal,document.body.appendChild(D(this,Ee,"f"))),D(this,Ee,"f").appendChild(t))}),Yt.set(this,t=>{if(!this.isInPortal(t))return;const{dismissCb:s,parent:n}=D(this,be,"f").get(t);D(this,tt,"f").removeClickCallback(s),n&&n.appendChild(t),D(this,be,"f").delete(t)}),Xt.set(this,t=>{D(this,ke,"f").queue.add(t),D(this,ke,"f").frameId||(D(this,ke,"f").frameId=requestAnimationFrame(()=>{D(this,ke,"f").frameId=0,D(this,ke,"f").queue.forEach(s=>D(this,js,"f").call(this,s)),D(this,ke,"f").queue.clear()}))}),js.set(this,t=>{if(!this.isInPortal(t)||!t.isConnected){D(this,Yt,"f").call(this,t);return}D(this,Kt,"f").call(this,t);const s=D(this,be,"f").get(t);if(!s){D(this,tt,"f").debug.logs.new(this,"State for element not found.","warning");return}const{anchor:n,margin:r,placement:i}=s,{offsetHeight:o,offsetWidth:l,style:c}=t;if(c.display="block",!D(this,Hs,"f").call(this,n)){const{x:U,y:ae}=n,he=window.innerHeight-ae,Rt=window.innerWidth-U;he<o&&ae>o?c.top=`${ae-o-r}px`:c.top=`${ae+r}px`,Rt<l&&U>l?c.left=`${U-l-r}px`:c.left=`${U+r}px`;return}const{top:f,bottom:d,left:u,right:p}=n.getBoundingClientRect(),m=window.innerHeight-d,b=f,v=u,w=window.innerWidth-p;let _="auto",F="auto";if(i==="auto")_="auto",F="auto";else{const U=i.toLowerCase();U.startsWith("t")?_="t":U.startsWith("b")?_="b":U.startsWith("l")||U.startsWith("r"),U.endsWith("l")?F="l":U.endsWith("r")&&(F="r")}let T=_;_==="auto"?m>=o||m>=b?T="b":T="t":_==="b"?m<o&&b>o&&(T="t"):_==="t"&&b<o&&m>o&&(T="b");let j=F;switch(F==="auto"?w>=l||w>=v?j="r":j="l":F==="r"?w<l&&v>l&&(j="l"):F==="l"&&v<l&&w>l&&(j="r"),T){case"t":c.bottom=`${window.innerHeight-f+r}px`;break;case"b":c.top=`${d+r}px`;break;default:c.top=o<f&&window.innerHeight-d<o?`${window.innerHeight-f+r}px`:`${d+r}px`;break}let q=window.innerWidth-document.documentElement.offsetWidth;switch(q>30&&(q=0),j){case"l":c.left=`${u}px`;break;case"r":c.right=`${window.innerWidth-q-p}px`;break;default:c.left=l<p&&window.innerWidth-u<l?`${window.innerWidth-q-p}px`:`${u}px`;break}requestAnimationFrame(()=>D(this,Xt,"f").call(this,t))}),Hs.set(this,t=>t.tagName!==void 0),Kt.set(this,t=>{const{style:s}=t;s.bottom="",s.display="",s.left="",s.right="",s.top=""}),this.close=t=>{D(this,Yt,"f").call(this,t),D(this,Kt,"f").call(this,t)},this.getState=t=>D(this,be,"f").get(t),this.isInPortal=t=>D(this,be,"f").has(t),this.open=(t,s,n=s,r=0,i="auto")=>{let o=D(this,be,"f").get(t);if(o)n&&(o.anchor=n),r!==void 0&&(o.margin=r),s&&(o.parent=s),i&&(o.placement=i);else{const l={cb:()=>{this.close(t)},element:t};D(this,be,"f").set(t,{anchor:n,dismissCb:l,margin:r,parent:s,placement:i}),D(this,tt,"f").addClickCallback(l,!0),D(this,Gs,"f").call(this,t)}D(this,Xt,"f").call(this,t)},Ra(this,tt,a,"f")}}ke=new WeakMap,tt=new WeakMap,Ee=new WeakMap,be=new WeakMap,Gs=new WeakMap,Yt=new WeakMap,Xt=new WeakMap,js=new WeakMap,Hs=new WeakMap,Kt=new WeakMap;var xe=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},C=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},Tt,K,Ft,Ce,Te,Zt,Dt,Qt,Js,qs,Ys,Xs,Ks,Nt;class Yr{constructor(a){Tt.set(this,new Set),K.set(this,void 0),Ft.set(this,"dark"),Ce.set(this,void 0),Te.set(this,void 0),Zt.set(this,"MASTER"),Dt.set(this,void 0),Qt.set(this,()=>{var s;const{logs:t}=C(this,Te,"f").debug;(s=C(this,Ce,"f"))!=null&&s[C(this,K,"f")]||(t.new(this,`Invalid theme! Falling back to (${C(this,Ft,"f")}).`),xe(this,K,C(this,Ft,"f"),"f"))}),Js.set(this,()=>{const{get:t}=C(this,Te,"f").assets;let s="";const{font:n}=this.get.current();return n!=null&&n.length&&n.forEach(r=>{const i=t(`./assets/fonts/${r}-Regular`).path;s+=`@font-face{font-family:${r.split("-")[0].replace(new RegExp("(?<!^)(?=[A-Z])","g")," ")};`,s+=`src:url('${i}.woff2')format('woff2');}`}),s}),qs.set(this,()=>{let t="";for(const[s,n]of Object.entries(ur))if(s.startsWith("@keyframes")){if(t+=`${s} { `,Array.isArray(n))for(const r of n)for(const[i,o]of Object.entries(r)){t+=`${i} { `;for(const[l,c]of Object.entries(o))t+=`${l}: ${c}; `;t+="} "}t+="} "}else{t+=`${s} { `;for(const[r,i]of Object.entries(n))t+=`${r}: ${i}; `;t+="} "}return t.trim()}),Ys.set(this,()=>{const{assets:t,color:s}=C(this,Te,"f");let n="";const{variables:r}=this.get.current();return Object.entries(r).forEach(([i,o])=>{switch(i){case(i.startsWith(pr)&&i):const{rgbValues:l}=s.compute(o);n+=`${i}: ${l};`;break;case(i.startsWith(hr)&&i):const c=t.get(`./assets/svg/${o}.svg`).path;n+=`${i}: url(${c}) no-repeat center;`;break;default:n+=`${i}: ${o};`;break}}),n}),Xs.set(this,()=>{C(this,Tt,"f").forEach(t=>{var s;(s=t==null?void 0:t.rootElement)!=null&&s.isConnected&&t.refresh()})}),Ks.set(this,()=>{const{isDark:t,name:s}=this.get.current(),n=document.documentElement;n.setAttribute(mt.theme,s),t?(n.removeAttribute(mt.light),n.setAttribute(mt.dark,"")):(n.removeAttribute(mt.dark),n.setAttribute(mt.light,"")),document.dispatchEvent(new CustomEvent("lf-theme-change"))}),Nt.set(this,()=>{let t="";t+=C(this,Js,"f").call(this),t+=C(this,qs,"f").call(this),t+=`:root[lf-theme="${C(this,K,"f")}"] {${C(this,Ys,"f").call(this)}}`,C(this,Dt,"f").innerText=t}),this.bemClass=(t,s,n)=>{let r=s?`${t}__${s}`:t;if(n){const i=Object.entries(n).filter(([o,l])=>l).map(([o])=>`${r}--${o}`);r+=` ${i.join(" ")}`}return r.trim()},this.get={current:()=>{C(this,Qt,"f").call(this);const{variables:t,isDark:s,customStyles:n,font:r}=C(this,Ce,"f")[C(this,K,"f")];return{variables:t,customStyles:n,font:r,isDark:s,name:C(this,K,"f"),full:C(this,Ce,"f")[C(this,K,"f")]}},icon:t=>Fa[t],icons:()=>Fa,themes:()=>{const t=[],s=[];return Object.keys(C(this,Ce,"f")).forEach(n=>{const r=n.charAt(0).toUpperCase();t.push(n),s.push({id:n,value:`${r}${n.substring(1)}`})}),{asArray:t,asDataset:{nodes:[{icon:this.get.icon("colorSwatch"),id:"root",value:"Random",children:s}]}}}},this.set=(t,s)=>{typeof document>"u"||(C(this,Dt,"f")||xe(this,Dt,document.documentElement.querySelector("head").appendChild(document.createElement("style")),"f"),t&&xe(this,K,t,"f"),s&&xe(this,Ce,s,"f"),C(this,Qt,"f").call(this),C(this,Nt,"f").call(this),C(this,Xs,"f").call(this),C(this,Ks,"f").call(this))},this.refresh=()=>{const{logs:t}=C(this,Te,"f").debug;try{C(this,Nt,"f").call(this),t.new(this,"Theme "+C(this,K,"f")+" refreshed."),document.dispatchEvent(new CustomEvent("lf-theme-refresh"))}catch{t.new(this,"Theme not refreshed.","warning")}},this.setLfStyle=t=>{const s=o=>!!(!o||/javascript:/i.test(o)||/<script>/i.test(o)||/url\(.*(javascript|data):/i.test(o));let n="";const{customStyles:r}=this.get.current(),i=t.rootElement.tagName;return r!=null&&r[C(this,Zt,"f")]&&(n+=r[C(this,Zt,"f")]),r!=null&&r[i]&&(n+=` ${r[i]}`),t.lfStyle&&(n+=` ${t.lfStyle}`),!s(n)&&n||""},this.randomize=()=>{const{logs:t}=C(this,Te,"f").debug,s=this.get.themes().asArray;if(s.length>0){let n=null;for(;n===null||s[n]===C(this,K,"f");)n=Math.floor(Math.random()*Math.floor(s.length));this.set(s[n])}else t.new(this,"Couldn't randomize theme: no themes available!","warning")},this.register=t=>{C(this,Tt,"f").add(t)},this.unregister=t=>{var s;(s=C(this,Tt,"f"))==null||s.delete(t)},xe(this,Te,a,"f"),xe(this,Ce,gr,"f"),xe(this,K,C(this,Ft,"f"),"f")}}Tt=new WeakMap,K=new WeakMap,Ft=new WeakMap,Ce=new WeakMap,Te=new WeakMap,Zt=new WeakMap,Dt=new WeakMap,Qt=new WeakMap,Js=new WeakMap,qs=new WeakMap,Ys=new WeakMap,Xs=new WeakMap,Ks=new WeakMap,Nt=new WeakMap;var ne=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},Xr=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},es,ie,Zs;class Kr{constructor(){es.set(this,!1),ie.set(this,new Map([["lf-framework",{name:"lf-framework",getAssetPath:Lr,setAssetPath:Sr}]])),Zs.set(this,()=>{typeof document>"u"||document.addEventListener("click",a=>{const{utilities:t,portal:s}=this,{clickCallbacks:n}=t,r=a.composedPath();n.forEach(({cb:i,element:o})=>{if(!(o!=null&&o.isConnected)){i();return}if(r.includes(o))return;const l=s.getState(o);if(l){const{parent:c}=l;r.includes(c)||i()}else i()})})}),this.addClickCallback=(a,t)=>{const{utilities:s}=this,{clickCallbacks:n}=s;ne(this,es,"f")||(Xr(this,es,!0,"f"),ne(this,Zs,"f").call(this)),t?requestAnimationFrame(async()=>n.add(a)):n.add(a)},this.assignRef=(a,t)=>s=>{s&&(a[t]=s)},this.getModules=()=>ne(this,ie,"f"),this.register=(a,t)=>{if(ne(this,ie,"f").has(a)){this.debug.logs.new(this,`Module ${a} is already registered.`,"error");return}ne(this,ie,"f").set(a,{name:a,...t}),this.debug.logs.new(this,`Module ${a} registered.`)},this.removeClickCallback=a=>{this.utilities.clickCallbacks.delete(a)},this.assets={get:(a,t="lf-framework")=>{if(!ne(this,ie,"f").has(t))return this.debug.logs.new(this,`Module ${t} is not registered.`,"error"),{path:"",style:{mask:"",webkitMask:""}};const{getAssetPath:s}=ne(this,ie,"f").get(t),n=s(a),r={mask:`url('${n}') no-repeat center`,webkitMask:`url('${n}') no-repeat center`};return{path:n,style:r}},set:(a,t)=>{if(!t)ne(this,ie,"f").forEach(({setAssetPath:s})=>s(a));else if(ne(this,ie,"f").has(t)){const{setAssetPath:s}=ne(this,ie,"f").get(t);s(a)}}},this.color=new Fr(this),this.data=new Vr(this),this.debug=new Ur(this),this.drag=new zr(this),this.effects=new Gr(this),this.llm=new Jr(this),this.portal=new qr(this),this.theme=new Yr(this),this.utilities={clickCallbacks:new Set}}sanitizeProps(a,t){const s=new Set(lr),n=new Set(cr),r=fr();if(t&&r[t])for(const c of r[t])s.add(c);const i=c=>!!(s.has(c)||n.has(c.split("-")[0])),o=c=>typeof c!="string"?!1:!!(/javascript:/i.test(c)||/<script>/i.test(c)),l={};for(const c in a){if(!Object.prototype.hasOwnProperty.call(a,c))continue;const f=a[c];c.toLowerCase().startsWith("on")||i(c)&&(o(f)||(l[c]=f))}return l}}es=new WeakMap,ie=new WeakMap,Zs=new WeakMap;const Wa=typeof window<"u";let It=null;function hn(){if(!It&&(Zr(),!It))throw new Error("Failed to initialize LfFramework.");return It}function Zr(){if(Wa&&window[rn]||It)return;const a=new Kr;It=a,Wa&&Qr(a)}const Qr=e=>{window[rn]=e,dr(e);const a=new CustomEvent(mr,{detail:{lfFramework:e}});document.dispatchEvent(a)},Nr="lf-core",$a={hydratedSelectorName:"lf-hydrated",lazyLoad:!0,updatable:!0};var eo=Object.defineProperty,to=(e,a)=>{for(var t in a)eo(e,t,{get:a[t],enumerable:!0})},so="http://www.w3.org/2000/svg",ao="http://www.w3.org/1999/xhtml",pn=new WeakMap,se=e=>pn.get(e),no=(e,a)=>{const t={$flags$:0,$hostElement$:e,$cmpMeta$:a,$instanceValues$:new Map};return t.$onInstancePromise$=new Promise(n=>t.$onInstanceResolve$=n),t.$onReadyPromise$=new Promise(n=>t.$onReadyResolve$=n),e["s-p"]=[],e["s-rc"]=[],pn.set(e,t)},Ba=(e,a)=>a in e,ze=(e,a)=>(0,console.error)(e,a),Va=new Map,ro=(e,a,t)=>{const s=e.$tagName$.replace(/-/g,"_"),n=e.$lazyBundleId$;if(!n)return;const r=Va.get(n);if(r)return r[s];/*!__STENCIL_STATIC_IMPORT_SWITCH__*/return yr(()=>import(`./${n}.entry.js`),[],import.meta.url).then(i=>(Va.set(n,i),i[s]),i=>{ze(i,a.$hostElement$)})},rs=new Map,oo="sty-id",io="{visibility:hidden}[lf-hydrated]{visibility:inherit}",gn="slot-fb{display:contents}slot-fb[hidden]{display:none}",Ua="http://www.w3.org/1999/xlink",Ls=typeof window<"u"?window:{},de=Ls.document||{head:{}},V={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,a,t,s)=>e.addEventListener(a,t,s),rel:(e,a,t,s)=>e.removeEventListener(a,t,s),ce:(e,a)=>new CustomEvent(e,a)},lo=(()=>{let e=!1;try{de.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch{}return e})(),co=e=>Promise.resolve(e),mn=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),Qs=!1,za=[],yn=[],fo=(e,a)=>t=>{e.push(t),Qs||(Qs=!0,V.$flags$&4?_a(Ns):V.raf(Ns))},Ga=e=>{for(let a=0;a<e.length;a++)try{e[a](performance.now())}catch(t){ze(t)}e.length=0},Ns=()=>{Ga(za),Ga(yn),(Qs=za.length>0)&&V.raf(Ns)},_a=e=>co().then(e),uo=fo(yn),ka=e=>(e=typeof e,e==="object"||e==="function");function bn(e){var a,t,s;return(s=(t=(a=e.head)==null?void 0:a.querySelector('meta[name="csp-nonce"]'))==null?void 0:t.getAttribute("content"))!=null?s:void 0}var ho={};to(ho,{err:()=>wn,map:()=>po,ok:()=>ea,unwrap:()=>go,unwrapErr:()=>mo});var ea=e=>({isOk:!0,isErr:!1,value:e}),wn=e=>({isOk:!1,isErr:!0,value:e});function po(e,a){if(e.isOk){const t=a(e.value);return t instanceof Promise?t.then(s=>ea(s)):ea(t)}if(e.isErr){const t=e.value;return wn(t)}throw"should never get here"}var go=e=>{if(e.isOk)return e.value;throw e.value},mo=e=>{if(e.isErr)return e.value;throw e.value},ve=(e,a="")=>()=>{},yo=(e,a)=>()=>{},bo=(e,a,...t)=>{let s=null,n=null,r=!1,i=!1;const o=[],l=f=>{for(let d=0;d<f.length;d++)s=f[d],Array.isArray(s)?l(s):s!=null&&typeof s!="boolean"&&((r=!ka(s))&&(s=String(s)),r&&i?o[o.length-1].$text$+=s:o.push(r?ta(null,s):s),i=r)};l(t);const c=ta(e,null);return c.$attrs$=a,o.length>0&&(c.$children$=o),c.$key$=n,c},ta=(e,a)=>{const t={$flags$:0,$tag$:e,$text$:a,$elm$:null,$children$:null};return t.$attrs$=null,t.$key$=null,t},wo={},vo=e=>e&&e.$tag$===wo,sa=(e,a)=>e!=null&&!ka(e)?a&4?e==="false"?!1:e===""||!!e:a&2?parseFloat(e):a&1?String(e):e:e,Lo=(e,a,t)=>{const s=V.ce(a,t);return e.dispatchEvent(s),s},it=new WeakMap,So=(e,a,t)=>{let s=rs.get(e);mn&&t?(s=s||new CSSStyleSheet,typeof s=="string"?s=a:s.replaceSync(a)):s=a,rs.set(e,s)},$o=(e,a,t)=>{var s;const n=vn(a),r=rs.get(n);if(e=e.nodeType===11?e:de,r)if(typeof r=="string"){e=e.head||e;let i=it.get(e),o;if(i||it.set(e,i=new Set),!i.has(n)){{o=document.querySelector(`[${oo}="${n}"]`)||de.createElement("style"),o.innerHTML=r;const l=(s=V.$nonce$)!=null?s:bn(de);if(l!=null&&o.setAttribute("nonce",l),!(a.$flags$&1))if(e.nodeName==="HEAD"){const c=e.querySelectorAll("link[rel=preconnect]"),f=c.length>0?c[c.length-1].nextSibling:e.querySelector("style");e.insertBefore(o,(f==null?void 0:f.parentNode)===e?f:null)}else if("host"in e)if(mn){const c=new CSSStyleSheet;c.replaceSync(r),e.adoptedStyleSheets=[c,...e.adoptedStyleSheets]}else{const c=e.querySelector("style");c?c.innerHTML=r+c.innerHTML:e.prepend(o)}else e.append(o);a.$flags$&1&&e.nodeName!=="HEAD"&&e.insertBefore(o,null)}a.$flags$&4&&(o.innerHTML+=gn),i&&i.add(n)}}else e.adoptedStyleSheets.includes(r)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,r]);return n},_o=e=>{const a=e.$cmpMeta$,t=e.$hostElement$,s=a.$flags$,n=ve("attachStyles",a.$tagName$),r=$o(t.shadowRoot?t.shadowRoot:t.getRootNode(),a);s&10&&s&2&&(t["s-sc"]=r,t.classList.add(r+"-h")),n()},vn=(e,a)=>"sc-"+e.$tagName$,ja=(e,a,t,s,n,r,i)=>{if(t!==s){let o=Ba(e,a),l=a.toLowerCase();if(a==="class"){const c=e.classList,f=Ha(t);let d=Ha(s);c.remove(...f.filter(u=>u&&!d.includes(u))),c.add(...d.filter(u=>u&&!f.includes(u)))}else if(a==="style"){for(const c in t)(!s||s[c]==null)&&(c.includes("-")?e.style.removeProperty(c):e.style[c]="");for(const c in s)(!t||s[c]!==t[c])&&(c.includes("-")?e.style.setProperty(c,s[c]):e.style[c]=s[c])}else if(a!=="key")if(a==="ref")s&&s(e);else if(!o&&a[0]==="o"&&a[1]==="n"){if(a[2]==="-"?a=a.slice(3):Ba(Ls,l)?a=l.slice(2):a=l[2]+a.slice(3),t||s){const c=a.endsWith(Ln);a=a.replace(Eo,""),t&&V.rel(e,a,t,c),s&&V.ael(e,a,s,c)}}else{const c=ka(s);if((o||c&&s!==null)&&!n)try{if(e.tagName.includes("-"))e[a]!==s&&(e[a]=s);else{const d=s??"";a==="list"?o=!1:(t==null||e[a]!=d)&&(typeof e.__lookupSetter__(a)=="function"?e[a]=d:e.setAttribute(a,d))}}catch{}let f=!1;l!==(l=l.replace(/^xlink\:?/,""))&&(a=l,f=!0),s==null||s===!1?(s!==!1||e.getAttribute(a)==="")&&(f?e.removeAttributeNS(Ua,a):e.removeAttribute(a)):(!o||r&4||n)&&!c&&(s=s===!0?"":s,f?e.setAttributeNS(Ua,a,s):e.setAttribute(a,s))}}},ko=/\s/,Ha=e=>(typeof e=="object"&&e&&"baseVal"in e&&(e=e.baseVal),!e||typeof e!="string"?[]:e.split(ko)),Ln="Capture",Eo=new RegExp(Ln+"$"),Sn=(e,a,t,s)=>{const n=a.$elm$.nodeType===11&&a.$elm$.host?a.$elm$.host:a.$elm$,r=e&&e.$attrs$||{},i=a.$attrs$||{};for(const o of Ja(Object.keys(r)))o in i||ja(n,o,r[o],void 0,t,a.$flags$);for(const o of Ja(Object.keys(i)))ja(n,o,r[o],i[o],t,a.$flags$)};function Ja(e){return e.includes("ref")?[...e.filter(a=>a!=="ref"),"ref"]:e}var Ea,$n=!1,Y=!1,os=(e,a,t)=>{const s=a.$children$[t];let n=0,r,i;if(s.$text$!==null)r=s.$elm$=de.createTextNode(s.$text$);else{if(Y||(Y=s.$tag$==="svg"),r=s.$elm$=de.createElementNS(Y?so:ao,s.$tag$),Y&&s.$tag$==="foreignObject"&&(Y=!1),Sn(null,s,Y),s.$children$)for(n=0;n<s.$children$.length;++n)i=os(e,s,n),i&&r.appendChild(i);s.$tag$==="svg"?Y=!1:r.tagName==="foreignObject"&&(Y=!0)}return r["s-hn"]=Ea,r},_n=(e,a,t,s,n,r)=>{let i=e,o;for(i.shadowRoot&&i.tagName===Ea&&(i=i.shadowRoot);n<=r;++n)s[n]&&(o=os(null,t,n),o&&(s[n].$elm$=o,ts(i,o,a)))},kn=(e,a,t)=>{for(let s=a;s<=t;++s){const n=e[s];if(n){const r=n.$elm$;En(n),r&&r.remove()}}},Co=(e,a,t,s,n=!1)=>{let r=0,i=0,o=0,l=0,c=a.length-1,f=a[0],d=a[c],u=s.length-1,p=s[0],m=s[u],b,v;for(;r<=c&&i<=u;)if(f==null)f=a[++r];else if(d==null)d=a[--c];else if(p==null)p=s[++i];else if(m==null)m=s[--u];else if(Wt(f,p,n))st(f,p,n),f=a[++r],p=s[++i];else if(Wt(d,m,n))st(d,m,n),d=a[--c],m=s[--u];else if(Wt(f,m,n))st(f,m,n),ts(e,f.$elm$,d.$elm$.nextSibling),f=a[++r],m=s[--u];else if(Wt(d,p,n))st(d,p,n),ts(e,d.$elm$,f.$elm$),d=a[--c],p=s[++i];else{for(o=-1,l=r;l<=c;++l)if(a[l]&&a[l].$key$!==null&&a[l].$key$===p.$key$){o=l;break}o>=0?(v=a[o],v.$tag$!==p.$tag$?b=os(a&&a[i],t,o):(st(v,p,n),a[o]=void 0,b=v.$elm$),p=s[++i]):(b=os(a&&a[i],t,i),p=s[++i]),b&&ts(f.$elm$.parentNode,b,f.$elm$)}r>c?_n(e,s[u+1]==null?null:s[u+1].$elm$,t,s,i,u):i>u&&kn(a,r,c)},Wt=(e,a,t=!1)=>e.$tag$===a.$tag$?t?(t&&!e.$key$&&a.$key$&&(e.$key$=a.$key$),!0):e.$key$===a.$key$:!1,st=(e,a,t=!1)=>{const s=a.$elm$=e.$elm$,n=e.$children$,r=a.$children$,i=a.$tag$,o=a.$text$;o===null?(Y=i==="svg"?!0:i==="foreignObject"?!1:Y,i==="slot"&&!$n||Sn(e,a,Y),n!==null&&r!==null?Co(s,n,a,r,t):r!==null?(e.$text$!==null&&(s.textContent=""),_n(s,null,a,r,0,r.length-1)):!t&&$a.updatable&&n!==null&&kn(n,0,n.length-1),Y&&i==="svg"&&(Y=!1)):e.$text$!==o&&(s.data=o)},En=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(En)},ts=(e,a,t)=>e==null?void 0:e.insertBefore(a,t),To=(e,a,t=!1)=>{const s=e.$hostElement$,n=e.$cmpMeta$,r=e.$vnode$||ta(null,null),i=vo(a)?a:bo(null,null,a);if(Ea=s.tagName,n.$attrsToReflect$&&(i.$attrs$=i.$attrs$||{},n.$attrsToReflect$.map(([o,l])=>i.$attrs$[l]=s[o])),t&&i.$attrs$)for(const o of Object.keys(i.$attrs$))s.hasAttribute(o)&&!["key","ref","style","class"].includes(o)&&(i.$attrs$[o]=s[o]);i.$tag$=null,i.$flags$|=4,e.$vnode$=i,i.$elm$=r.$elm$=s.shadowRoot||s,$n=(n.$flags$&1)!==0,st(r,i,t)},Cn=(e,a)=>{if(a&&!e.$onRenderResolve$&&a["s-p"]){const t=a["s-p"].push(new Promise(s=>e.$onRenderResolve$=()=>{a["s-p"].splice(t-1,1),s()}))}},Ca=(e,a)=>{if(e.$flags$|=16,e.$flags$&4){e.$flags$|=512;return}return Cn(e,e.$ancestorComponent$),uo(()=>Fo(e,a))},Fo=(e,a)=>{const t=e.$hostElement$,s=ve("scheduleUpdate",e.$cmpMeta$.$tagName$),n=e.$lazyInstance$;if(!n)throw new Error(`Can't render component <${t.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let r;return a?(e.$flags$|=256,e.$queuedListeners$&&(e.$queuedListeners$.map(([i,o])=>Ae(n,i,o,t)),e.$queuedListeners$=void 0),r=Ae(n,"componentWillLoad",void 0,t)):r=Ae(n,"componentWillUpdate",void 0,t),r=qa(r,()=>Ae(n,"componentWillRender",void 0,t)),s(),qa(r,()=>Ao(e,n,a))},qa=(e,a)=>Do(e)?e.then(a).catch(t=>{console.error(t),a()}):a(),Do=e=>e instanceof Promise||e&&e.then&&typeof e.then=="function",Ao=async(e,a,t)=>{var s;const n=e.$hostElement$,r=ve("update",e.$cmpMeta$.$tagName$),i=n["s-rc"];t&&_o(e);const o=ve("render",e.$cmpMeta$.$tagName$);xo(e,a,n,t),i&&(i.map(l=>l()),n["s-rc"]=void 0),o(),r();{const l=(s=n["s-p"])!=null?s:[],c=()=>Io(e);l.length===0?c():(Promise.all(l).then(c),e.$flags$|=4,l.length=0)}},xo=(e,a,t,s)=>{try{a=a.render(),e.$flags$&=-17,e.$flags$|=2,To(e,a,s)}catch(n){ze(n,e.$hostElement$)}return null},Io=e=>{const a=e.$cmpMeta$.$tagName$,t=e.$hostElement$,s=ve("postUpdate",a),n=e.$lazyInstance$,r=e.$ancestorComponent$;Ae(n,"componentDidRender",void 0,t),e.$flags$&64?s():(e.$flags$|=64,Po(t),Ae(n,"componentDidLoad",void 0,t),s(),e.$onReadyResolve$(t),r||Tn()),e.$onInstanceResolve$(t),e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),e.$flags$&512&&_a(()=>Ca(e,!1)),e.$flags$&=-517},Tn=e=>{_a(()=>Lo(Ls,"appload",{detail:{namespace:Nr}}))},Ae=(e,a,t,s)=>{if(e&&e[a])try{return e[a](t)}catch(n){ze(n,s)}},Po=e=>{var a;return e.setAttribute((a=$a.hydratedSelectorName)!=null?a:"hydrated","")},Oo=(e,a)=>se(e).$instanceValues$.get(a),ks=(e,a,t,s)=>{const n=se(e);if(!n)throw new Error(`Couldn't find host element for "${s.$tagName$}" as it is unknown to this Stencil runtime. This usually happens when integrating a 3rd party Stencil component with another Stencil component or application. Please reach out to the maintainers of the 3rd party Stencil component or report this on the Stencil Discord server (https://chat.stenciljs.com) or comment on this similar [GitHub issue](https://github.com/ionic-team/stencil/issues/5457).`);const r=n.$hostElement$,i=n.$instanceValues$.get(a),o=n.$flags$,l=n.$lazyInstance$;t=sa(t,s.$members$[a][0]);const c=Number.isNaN(i)&&Number.isNaN(t),f=t!==i&&!c;if((!(o&8)||i===void 0)&&f&&(n.$instanceValues$.set(a,t),l)){if(s.$watchers$&&o&128){const d=s.$watchers$[a];d&&d.map(u=>{try{l[u](t,i,a)}catch(p){ze(p,r)}})}(o&18)===2&&Ca(n,!1)}},Fn=(e,a,t)=>{var s,n;const r=e.prototype;if(a.$members$||a.$watchers$||e.watchers){e.watchers&&!a.$watchers$&&(a.$watchers$=e.watchers);const i=Object.entries((s=a.$members$)!=null?s:{});if(i.map(([o,[l]])=>{if(l&31||t&2&&l&32){const{get:c,set:f}=Object.getOwnPropertyDescriptor(r,o)||{};c&&(a.$members$[o][0]|=2048),f&&(a.$members$[o][0]|=4096),(t&1||!c)&&Object.defineProperty(r,o,{get(){{if(!(a.$members$[o][0]&2048))return Oo(this,o);const d=se(this),u=d?d.$lazyInstance$:r;return u?u[o]:void 0}},configurable:!0,enumerable:!0}),Object.defineProperty(r,o,{set(d){const u=se(this);if(f){const p=l&32?this[o]:u.$hostElement$[o];typeof p>"u"&&u.$instanceValues$.get(o)?d=u.$instanceValues$.get(o):!u.$instanceValues$.get(o)&&p&&u.$instanceValues$.set(o,p),f.apply(this,[sa(d,l)]),d=l&32?this[o]:u.$hostElement$[o],ks(this,o,d,a);return}{if(!(t&1)||!(a.$members$[o][0]&4096)){ks(this,o,d,a),t&1&&!u.$lazyInstance$&&u.$onReadyPromise$.then(()=>{a.$members$[o][0]&4096&&u.$lazyInstance$[o]!==u.$instanceValues$.get(o)&&(u.$lazyInstance$[o]=d)});return}const p=()=>{const m=u.$lazyInstance$[o];!u.$instanceValues$.get(o)&&m&&u.$instanceValues$.set(o,m),u.$lazyInstance$[o]=sa(d,l),ks(this,o,u.$lazyInstance$[o],a)};u.$lazyInstance$?p():u.$onReadyPromise$.then(()=>p())}}})}else t&1&&l&64&&Object.defineProperty(r,o,{value(...c){var f;const d=se(this);return(f=d==null?void 0:d.$onInstancePromise$)==null?void 0:f.then(()=>{var u;return(u=d.$lazyInstance$)==null?void 0:u[o](...c)})}})}),t&1){const o=new Map;r.attributeChangedCallback=function(l,c,f){V.jmp(()=>{var d;const u=o.get(l);if(this.hasOwnProperty(u)&&$a.lazyLoad)f=this[u],delete this[u];else{if(r.hasOwnProperty(u)&&typeof this[u]=="number"&&this[u]==f)return;if(u==null){const m=se(this),b=m==null?void 0:m.$flags$;if(b&&!(b&8)&&b&128&&f!==c){const v=m.$lazyInstance$,w=(d=a.$watchers$)==null?void 0:d[l];w==null||w.forEach(_=>{v[_]!=null&&v[_].call(v,f,c,l)})}return}}const p=Object.getOwnPropertyDescriptor(r,u);f=f===null&&typeof this[u]=="boolean"?!1:f,f!==this[u]&&(!p.get||p.set)&&(this[u]=f)})},e.observedAttributes=Array.from(new Set([...Object.keys((n=a.$watchers$)!=null?n:{}),...i.filter(([l,c])=>c[0]&15).map(([l,c])=>{var f;const d=c[1]||l;return o.set(d,l),c[0]&512&&((f=a.$attrsToReflect$)==null||f.push([l,d])),d})]))}}return e},Mo=async(e,a,t,s)=>{let n;if(!(a.$flags$&32)){if(a.$flags$|=32,t.$lazyBundleId$){const l=ro(t,a);if(l&&"then"in l){const f=yo();n=await l,f()}else n=l;if(!n)throw new Error(`Constructor for "${t.$tagName$}#${a.$modeName$}" was not found`);n.isProxied||(t.$watchers$=n.watchers,Fn(n,t,2),n.isProxied=!0);const c=ve("createInstance",t.$tagName$);a.$flags$|=8;try{new n(a)}catch(f){ze(f,e)}a.$flags$&=-9,a.$flags$|=128,c(),aa(a.$lazyInstance$,e)}else{n=e.constructor;const l=e.localName;customElements.whenDefined(l).then(()=>a.$flags$|=128)}if(n&&n.style){let l;typeof n.style=="string"&&(l=n.style);const c=vn(t);if(!rs.has(c)){const f=ve("registerStyles",t.$tagName$);So(c,l,!!(t.$flags$&1)),f()}}}const r=a.$ancestorComponent$,i=()=>Ca(a,!0);r&&r["s-rc"]?r["s-rc"].push(i):i()},aa=(e,a)=>{Ae(e,"connectedCallback",void 0,a)},Ro=e=>{if(!(V.$flags$&1)){const a=se(e),t=a.$cmpMeta$,s=ve("connectedCallback",t.$tagName$);if(a.$flags$&1)Dn(e,a,t.$listeners$),a!=null&&a.$lazyInstance$?aa(a.$lazyInstance$,e):a!=null&&a.$onReadyPromise$&&a.$onReadyPromise$.then(()=>aa(a.$lazyInstance$,e));else{a.$flags$|=1;{let n=e;for(;n=n.parentNode||n.host;)if(n["s-p"]){Cn(a,a.$ancestorComponent$=n);break}}t.$members$&&Object.entries(t.$members$).map(([n,[r]])=>{if(r&31&&e.hasOwnProperty(n)){const i=e[n];delete e[n],e[n]=i}}),Mo(e,a,t)}s()}},Ya=(e,a)=>{Ae(e,"disconnectedCallback",void 0,a||e)},Wo=async e=>{if(!(V.$flags$&1)){const a=se(e);a.$rmListeners$&&(a.$rmListeners$.map(t=>t()),a.$rmListeners$=void 0),a!=null&&a.$lazyInstance$?Ya(a.$lazyInstance$,e):a!=null&&a.$onReadyPromise$&&a.$onReadyPromise$.then(()=>Ya(a.$lazyInstance$,e))}it.has(e)&&it.delete(e),e.shadowRoot&&it.has(e.shadowRoot)&&it.delete(e.shadowRoot)},Bo=(e,a={})=>{var t;const s=ve(),n=[],r=a.exclude||[],i=Ls.customElements,o=de.head,l=o.querySelector("meta[charset]"),c=de.createElement("style"),f=[];let d,u=!0;Object.assign(V,a),V.$resourcesUrl$=new URL(a.resourcesUrl||"./",de.baseURI).href;let p=!1;if(e.map(m=>{m[1].map(b=>{var v;const w={$flags$:b[0],$tagName$:b[1],$members$:b[2],$listeners$:b[3]};w.$flags$&4&&(p=!0),w.$members$=b[2],w.$listeners$=b[3],w.$attrsToReflect$=[],w.$watchers$=(v=b[4])!=null?v:{};const _=w.$tagName$,F=class extends HTMLElement{constructor(T){if(super(T),this.hasRegisteredEventListeners=!1,T=this,no(T,w),w.$flags$&1){if(!T.shadowRoot)T.attachShadow({mode:"open"});else if(T.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${w.$tagName$}! Mode is set to ${T.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}connectedCallback(){const T=se(this);this.hasRegisteredEventListeners||(this.hasRegisteredEventListeners=!0,Dn(this,T,w.$listeners$)),d&&(clearTimeout(d),d=null),u?f.push(this):V.jmp(()=>Ro(this))}disconnectedCallback(){V.jmp(()=>Wo(this)),V.raf(()=>{var T;const j=se(this),q=f.findIndex(U=>U===this);q>-1&&f.splice(q,1),((T=j==null?void 0:j.$vnode$)==null?void 0:T.$elm$)instanceof Node&&!j.$vnode$.$elm$.isConnected&&delete j.$vnode$.$elm$})}componentOnReady(){return se(this).$onReadyPromise$}};w.$lazyBundleId$=m[0],!r.includes(_)&&!i.get(_)&&(n.push(_),i.define(_,Fn(F,w,1)))})}),n.length>0&&(p&&(c.textContent+=gn),c.textContent+=n.sort()+io,c.innerHTML.length)){c.setAttribute("data-styles","");const m=(t=V.$nonce$)!=null?t:bn(de);m!=null&&c.setAttribute("nonce",m),o.insertBefore(c,l?l.nextSibling:o.firstChild)}u=!1,f.length?f.map(m=>m.connectedCallback()):V.jmp(()=>d=setTimeout(Tn,30)),s()},Dn=(e,a,t,s)=>{t&&t.map(([n,r,i])=>{const o=e,l=Vo(a,i),c=Uo(n);V.ael(o,r,l,c),(a.$rmListeners$=a.$rmListeners$||[]).push(()=>V.rel(o,r,l,c))})},Vo=(e,a)=>t=>{var s;try{e.$flags$&256?(s=e.$lazyInstance$)==null||s[a](t):(e.$queuedListeners$=e.$queuedListeners$||[]).push([a,t])}catch(n){ze(n,e.$hostElement$)}},Uo=e=>lo?{passive:(e&1)!==0,capture:(e&2)!==0}:(e&2)!==0;const zo=()=>{},Go=async(e,a)=>{if(!(typeof window>"u"))return await zo(),Bo(JSON.parse('[["lf-messenger",[[1,"lf-messenger",{"lfAutosave":[1028,"lf-autosave"],"lfDataset":[1040],"lfStyle":[1025,"lf-style"],"lfValue":[16],"debugInfo":[32],"chat":[32],"connectionStatus":[32],"covers":[32],"currentCharacter":[32],"formStatusMap":[32],"history":[32],"hoveredCustomizationOption":[32],"saveInProgress":[32],"ui":[32],"deleteOption":[64],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"reset":[64],"save":[64],"unmount":[64]}]]],["lf-imageviewer",[[1,"lf-imageviewer",{"lfDataset":[1040],"lfLoadCallback":[1040],"lfStyle":[1025,"lf-style"],"lfValue":[1040],"debugInfo":[32],"currentShape":[32],"history":[32],"historyIndex":[32],"isSpinnerActive":[32],"addSnapshot":[64],"clearHistory":[64],"clearSelection":[64],"getComponents":[64],"getCurrentSnapshot":[64],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"reset":[64],"setSpinnerStatus":[64],"unmount":[64]}]]],["lf-compare",[[1,"lf-compare",{"lfDataset":[1040],"lfShape":[1025,"lf-shape"],"lfStyle":[1025,"lf-style"],"lfView":[1025,"lf-view"],"debugInfo":[32],"isLeftPanelOpened":[32],"isRightPanelOpened":[32],"leftShape":[32],"rightShape":[32],"shapes":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]},null,{"lfDataset":["updateShapes"],"lfShape":["updateShapes"]}]]],["lf-carousel",[[1,"lf-carousel",{"lfDataset":[1040],"lfAutoPlay":[4,"lf-auto-play"],"lfInterval":[2,"lf-interval"],"lfLightbox":[1540,"lf-lightbox"],"lfNavigation":[1028,"lf-navigation"],"lfShape":[1537,"lf-shape"],"lfStyle":[1025,"lf-style"],"debugInfo":[32],"currentIndex":[32],"shapes":[32],"getDebugInfo":[64],"getProps":[64],"goToSlide":[64],"nextSlide":[64],"prevSlide":[64],"refresh":[64],"unmount":[64]},null,{"lfDataset":["updateShapes"],"lfShape":["updateShapes"]}]]],["lf-badge",[[1,"lf-badge",{"lfImageProps":[1040],"lfLabel":[1025,"lf-label"],"lfPosition":[1025,"lf-position"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"debugInfo":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]}]]],["lf-photoframe",[[1,"lf-photoframe",{"lfOverlay":[1040],"lfPlaceholder":[16],"lfStyle":[1025,"lf-style"],"lfThreshold":[2,"lf-threshold"],"lfValue":[16],"debugInfo":[32],"imageOrientation":[32],"isInViewport":[32],"isReady":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]}]]],["lf-accordion",[[1,"lf-accordion",{"lfDataset":[1040],"lfRipple":[1028,"lf-ripple"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfStyle":[1025,"lf-style"],"debugInfo":[32],"expandedNodes":[32],"selectedNodes":[32],"getDebugInfo":[64],"getProps":[64],"getSelectedNodes":[64],"refresh":[64],"toggleNode":[64],"unmount":[64]}]]],["lf-article",[[1,"lf-article",{"lfDataset":[1040],"lfEmpty":[1025,"lf-empty"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"debugInfo":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]}]]],["lf-card",[[1,"lf-card",{"lfDataset":[1040],"lfLayout":[1025,"lf-layout"],"lfSizeX":[1025,"lf-size-x"],"lfSizeY":[1025,"lf-size-y"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"debugInfo":[32],"shapes":[32],"getDebugInfo":[64],"getProps":[64],"getShapes":[64],"refresh":[64],"unmount":[64]},null,{"lfDataset":["updateShapes"]}]]],["lf-chart",[[1,"lf-chart",{"lfAxis":[1025,"lf-axis"],"lfColors":[1040],"lfDataset":[1040],"lfLegend":[1025,"lf-legend"],"lfSeries":[1040],"lfSizeX":[1025,"lf-size-x"],"lfSizeY":[1025,"lf-size-y"],"lfStyle":[1025,"lf-style"],"lfTypes":[1040],"lfXAxis":[1040],"lfYAxis":[1040],"debugInfo":[32],"themeValues":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"resize":[64],"unmount":[64]}]]],["lf-drawer",[[1,"lf-drawer",{"lfDisplay":[1537,"lf-display"],"lfPosition":[1537,"lf-position"],"lfResponsive":[1026,"lf-responsive"],"lfStyle":[1025,"lf-style"],"lfValue":[1540,"lf-value"],"debugInfo":[32],"close":[64],"getDebugInfo":[64],"getProps":[64],"isOpened":[64],"open":[64],"refresh":[64],"toggle":[64],"unmount":[64]},[[0,"keydown","listenKeydown"]],{"lfDisplay":["onLfDisplayChange"],"lfResponsive":["onLfResponsiveChange"]}]]],["lf-header",[[1,"lf-header",{"lfStyle":[1025,"lf-style"],"debugInfo":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]}]]],["lf-placeholder",[[1,"lf-placeholder",{"lfIcon":[1,"lf-icon"],"lfProps":[16],"lfStyle":[1025,"lf-style"],"lfThreshold":[2,"lf-threshold"],"lfTrigger":[1,"lf-trigger"],"lfValue":[1,"lf-value"],"debugInfo":[32],"isInViewport":[32],"getComponent":[64],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]}]]],["lf-slider",[[1,"lf-slider",{"lfLabel":[1025,"lf-label"],"lfLeadingLabel":[1028,"lf-leading-label"],"lfMax":[2,"lf-max"],"lfMin":[2,"lf-min"],"lfStep":[2,"lf-step"],"lfRipple":[1028,"lf-ripple"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[1026,"lf-value"],"debugInfo":[32],"value":[32],"getDebugInfo":[64],"getProps":[64],"getValue":[64],"refresh":[64],"setValue":[64],"unmount":[64]}]]],["lf-splash",[[1,"lf-splash",{"lfLabel":[1025,"lf-label"],"lfStyle":[1025,"lf-style"],"debugInfo":[32],"state":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]}]]],["lf-toast",[[1,"lf-toast",{"lfCloseIcon":[1025,"lf-close-icon"],"lfCloseCallback":[16],"lfIcon":[1025,"lf-icon"],"lfTimer":[2,"lf-timer"],"lfMessage":[1025,"lf-message"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"debugInfo":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]}]]],["lf-toggle",[[1,"lf-toggle",{"lfLabel":[1025,"lf-label"],"lfLeadingLabel":[1028,"lf-leading-label"],"lfRipple":[1028,"lf-ripple"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[4,"lf-value"],"debugInfo":[32],"value":[32],"getDebugInfo":[64],"getProps":[64],"getValue":[64],"refresh":[64],"setValue":[64],"unmount":[64]}]]],["lf-upload",[[1,"lf-upload",{"lfLabel":[1025,"lf-label"],"lfRipple":[1028,"lf-ripple"],"lfStyle":[1025,"lf-style"],"lfValue":[16],"debugInfo":[32],"selectedFiles":[32],"getDebugInfo":[64],"getProps":[64],"getValue":[64],"refresh":[64],"unmount":[64]}]]],["lf-button_3",[[1,"lf-button",{"lfDataset":[1040],"lfIcon":[1025,"lf-icon"],"lfIconOff":[1025,"lf-icon-off"],"lfLabel":[1025,"lf-label"],"lfRipple":[1028,"lf-ripple"],"lfShowSpinner":[1540,"lf-show-spinner"],"lfStretchX":[1540,"lf-stretch-x"],"lfStretchY":[1540,"lf-stretch-y"],"lfStyle":[1025,"lf-style"],"lfStyling":[1025,"lf-styling"],"lfToggable":[1028,"lf-toggable"],"lfTrailingIcon":[1028,"lf-trailing-icon"],"lfType":[1025,"lf-type"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[4,"lf-value"],"debugInfo":[32],"value":[32],"getDebugInfo":[64],"getProps":[64],"getValue":[64],"refresh":[64],"setMessage":[64],"setValue":[64],"unmount":[64]}],[1,"lf-list",{"lfDataset":[1040],"lfEmpty":[1025,"lf-empty"],"lfEnableDeletions":[1028,"lf-enable-deletions"],"lfNavigation":[1028,"lf-navigation"],"lfRipple":[1028,"lf-ripple"],"lfSelectable":[1028,"lf-selectable"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[2,"lf-value"],"debugInfo":[32],"focused":[32],"selected":[32],"focusNext":[64],"focusPrevious":[64],"getDebugInfo":[64],"getProps":[64],"getSelected":[64],"refresh":[64],"selectNode":[64],"unmount":[64]},[[0,"keydown","listenKeydown"]]],[1,"lf-spinner",{"lfActive":[1540,"lf-active"],"lfBarVariant":[1540,"lf-bar-variant"],"lfDimensions":[1025,"lf-dimensions"],"lfFader":[1028,"lf-fader"],"lfFaderTimeout":[1026,"lf-fader-timeout"],"lfFullScreen":[1540,"lf-full-screen"],"lfLayout":[1026,"lf-layout"],"lfStyle":[1025,"lf-style"],"lfTimeout":[1026,"lf-timeout"],"bigWait":[32],"debugInfo":[32],"progress":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]},null,{"lfBarVariant":["lfBarVariantChanged"],"lfTimeout":["lfTimeoutChanged"]}]]],["lf-canvas_2",[[1,"lf-masonry",{"lfActions":[1028,"lf-actions"],"lfColumns":[1026,"lf-columns"],"lfDataset":[1040],"lfSelectable":[1540,"lf-selectable"],"lfShape":[1025,"lf-shape"],"lfStyle":[1025,"lf-style"],"lfView":[1025,"lf-view"],"debugInfo":[32],"selectedShape":[32],"shapes":[32],"viewportWidth":[32],"getDebugInfo":[64],"getProps":[64],"getSelectedShape":[64],"redecorateShapes":[64],"refresh":[64],"setSelectedShape":[64],"unmount":[64]},null,{"lfColumns":["validateColumns"],"lfDataset":["updateShapes"],"lfShape":["updateShapes"]}],[1,"lf-canvas",{"lfBrush":[1025,"lf-brush"],"lfColor":[1025,"lf-color"],"lfCursor":[1025,"lf-cursor"],"lfImageProps":[1040],"lfOpacity":[1026,"lf-opacity"],"lfPreview":[1028,"lf-preview"],"lfStrokeTolerance":[1026,"lf-stroke-tolerance"],"lfSize":[1026,"lf-size"],"lfStyle":[1025,"lf-style"],"debugInfo":[32],"isPainting":[32],"points":[32],"clearCanvas":[64],"getCanvas":[64],"getDebugInfo":[64],"getImage":[64],"getProps":[64],"refresh":[64],"resizeCanvas":[64],"setCanvasHeight":[64],"setCanvasWidth":[64],"unmount":[64]}]]],["lf-tree",[[1,"lf-tree",{"lfAccordionLayout":[1540,"lf-accordion-layout"],"lfDataset":[1040],"lfFilter":[1028,"lf-filter"],"lfEmpty":[1025,"lf-empty"],"lfInitialExpansionDepth":[1026,"lf-initial-expansion-depth"],"lfRipple":[1028,"lf-ripple"],"lfSelectable":[1540,"lf-selectable"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"debugInfo":[32],"expandedNodes":[32],"hiddenNodes":[32],"selectedNode":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]}]]],["lf-image",[[1,"lf-image",{"lfHtmlAttributes":[1040],"lfShowSpinner":[1028,"lf-show-spinner"],"lfSizeX":[1025,"lf-size-x"],"lfSizeY":[1025,"lf-size-y"],"lfStyle":[1025,"lf-style"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[1025,"lf-value"],"debugInfo":[32],"error":[32],"isLoaded":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]},null,{"lfValue":["resetState"]}]]],["lf-textfield",[[1,"lf-textfield",{"lfHelper":[1040],"lfHtmlAttributes":[1040],"lfIcon":[1025,"lf-icon"],"lfLabel":[1025,"lf-label"],"lfStretchX":[1540,"lf-stretch-x"],"lfStretchY":[1540,"lf-stretch-y"],"lfStyle":[1025,"lf-style"],"lfStyling":[1025,"lf-styling"],"lfTrailingIcon":[1540,"lf-trailing-icon"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[1,"lf-value"],"debugInfo":[32],"status":[32],"value":[32],"getDebugInfo":[64],"getProps":[64],"getValue":[64],"refresh":[64],"setBlur":[64],"setFocus":[64],"setValue":[64],"unmount":[64]}]]],["lf-code_3",[[1,"lf-code",{"lfFormat":[1028,"lf-format"],"lfLanguage":[1025,"lf-language"],"lfPreserveSpaces":[1028,"lf-preserve-spaces"],"lfShowCopy":[1028,"lf-show-copy"],"lfShowHeader":[1028,"lf-show-header"],"lfStickyHeader":[1028,"lf-sticky-header"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[1025,"lf-value"],"debugInfo":[32],"value":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]},null,{"lfLanguage":["loadLanguage"]}],[1,"lf-progressbar",{"lfAnimated":[1540,"lf-animated"],"lfCenteredLabel":[1540,"lf-centered-label"],"lfIcon":[1537,"lf-icon"],"lfIsRadial":[1540,"lf-is-radial"],"lfLabel":[1025,"lf-label"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[1026,"lf-value"],"debugInfo":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]}],[1,"lf-typewriter",{"lfCursor":[1025,"lf-cursor"],"lfDeleteSpeed":[1026,"lf-delete-speed"],"lfLoop":[1028,"lf-loop"],"lfPause":[1026,"lf-pause"],"lfSpeed":[1026,"lf-speed"],"lfStyle":[1025,"lf-style"],"lfTag":[1025,"lf-tag"],"lfUiSize":[1537,"lf-ui-size"],"lfUpdatable":[1028,"lf-updatable"],"lfValue":[1025,"lf-value"],"debugInfo":[32],"displayedText":[32],"isDeleting":[32],"currentTextIndex":[32],"getDebugInfo":[64],"getProps":[64],"refresh":[64],"unmount":[64]},null,{"lfValue":["handleLfValueChange"]}]]],["lf-chat_3",[[1,"lf-chat",{"lfContextWindow":[1026,"lf-context-window"],"lfEmpty":[1025,"lf-empty"],"lfEndpointUrl":[1025,"lf-endpoint-url"],"lfLayout":[1025,"lf-layout"],"lfMaxTokens":[1026,"lf-max-tokens"],"lfPollingInterval":[1026,"lf-polling-interval"],"lfSeed":[1026,"lf-seed"],"lfStyle":[1025,"lf-style"],"lfSystem":[1025,"lf-system"],"lfTemperature":[1026,"lf-temperature"],"lfTypewriterProps":[1040],"lfUiSize":[1537,"lf-ui-size"],"lfValue":[1040],"debugInfo":[32],"history":[32],"currentPrompt":[32],"currentTokens":[32],"status":[32],"view":[32],"getDebugInfo":[64],"getHistory":[64],"getLastMessage":[64],"getProps":[64],"refresh":[64],"setHistory":[64],"unmount":[64]},[[0,"keydown","listenKeydown"]],{"lfPollingInterval":["updatePollingInterval"],"lfSystem":["updateTokensCount"]}],[1,"lf-tabbar",{"lfDataset":[16],"lfNavigation":[4,"lf-navigation"],"lfRipple":[1028,"lf-ripple"],"lfStyle":[1025,"lf-style"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[8,"lf-value"],"debugInfo":[32],"value":[32],"getDebugInfo":[64],"getProps":[64],"getValue":[64],"refresh":[64],"setValue":[64],"unmount":[64]}],[1,"lf-chip",{"lfDataset":[1040],"lfRipple":[1028,"lf-ripple"],"lfStyle":[1025,"lf-style"],"lfStyling":[1025,"lf-styling"],"lfUiSize":[1537,"lf-ui-size"],"lfUiState":[1025,"lf-ui-state"],"lfValue":[16],"debugInfo":[32],"expandedNodes":[32],"hiddenNodes":[32],"selectedNodes":[32],"getDebugInfo":[64],"getProps":[64],"getSelectedNodes":[64],"refresh":[64],"setSelectedNodes":[64],"unmount":[64]}]]]]'),a)};(function(){if(typeof window<"u"&&window.Reflect!==void 0&&window.customElements!==void 0){var e=HTMLElement;window.HTMLElement=function(){return Reflect.construct(e,[],this.constructor)},HTMLElement.prototype=e.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,e)}})();var N;(function(e){e.ClearAnalytics="/lf-nodes/clear-analytics",e.ClearMetadata="/lf-nodes/clear-metadata",e.GetAnalytics="/lf-nodes/get-analytics",e.GetImage="/lf-nodes/get-image",e.GetJson="/lf-nodes/get-json",e.GetMetadata="/lf-nodes/get-metadata",e.NewBackup="/lf-nodes/new-backup",e.ProcessImage="/lf-nodes/process-image",e.SaveMetadata="/lf-nodes/save-metadata",e.UpdateJson="/lf-nodes/update-json",e.UpdateMetadataCover="/lf-nodes/update-metadata-cover"})(N||(N={}));var g;(function(e){e.Info="info",e.Success="success",e.Warning="warning",e.Error="error"})(g||(g={}));const jo={clear:async e=>{const a=S(),t={message:"",status:g.Info};try{const s=new FormData;s.append("type",e);const n=await X.fetchApi(N.ClearAnalytics,{body:s,method:"POST"});switch(n.status){case 200:const i=await n.json();i.status==="success"&&(t.message=i.message,t.status=g.Error,a.getCachedDatasets().usage={});break;case 404:t.message=`Analytics not found: ${e}. Skipping deletion.`,t.status=g.Info;break;default:t.message=`Unexpected response from the clear-analytics ${e} API: ${i.message}`,t.status=g.Error;break}}catch(s){t.message=s,t.status=g.Error}return a.log(t.message,{payload:t},t.status),t},get:async(e,a)=>{const t=S(),s={data:{},message:"",status:g.Info};if(!e||!a)return s.message=`Missing directory (received ${e}) or  (received ${a}).`,s.status=g.Error,t.log(s.message,{payload:s},g.Error),s;try{const n=new FormData;n.append("directory",e),n.append("type",a);const r=await X.fetchApi(N.GetAnalytics,{body:n,method:"POST"});switch(r.status){case 200:const o=await r.json();o.status==="success"&&(s.data=o.data,s.message="Analytics data fetched successfully.",s.status=g.Success,t.log(s.message,{payload:s},s.status),t.getCachedDatasets().usage=s.data);break;case 404:s.status=g.Info,t.log(`${a} analytics file not found.`,{payload:s},s.status);break;default:s.message=`Unexpected response from the get-analytics ${a} API: ${o.message}`,s.status=g.Error;break}}catch(n){s.message=n,s.status=g.Error}return t.log(s.message,{payload:s},s.status),s}},Ho={new:async(e="automatic")=>{const a=S(),t={message:"",status:g.Info};try{const s=new FormData;s.append("backup_type",e);const n=await X.fetchApi(N.NewBackup,{body:s,method:"POST"});switch(n.status){case 200:const i=await n.json();i.status==="success"&&(t.message=i.message,t.status=g.Success);break;default:t.message="Unexpected response from the API!",t.status=g.Error;break}}catch(s){t.message=s,t.status=g.Error}return a.log(t.message,{payload:t},t.status),t}},Jo={comfyUi:()=>window.comfyAPI,event:(e,a)=>{X.addEventListener(e,a)},executeCommand:e=>{try{pe.extensionManager.command.execute(e)}catch(a){S().log(`Command ${e} not executed!`,{error:a},g.Warning)}},getDragAndScale:()=>pe.canvas.ds,getLinkById:e=>pe.graph.links[String(e).valueOf()],getNodeById:e=>pe.graph.getNodeById(+(e||pe.runningNodeId)),getResourceUrl:(e,a,t="output")=>`/view?${["filename="+encodeURIComponent(a),"type="+t,"subfolder="+e,pe.getRandParam().substring(1)].join("&")}`,interrupt:()=>X.interrupt(),queuePrompt:async()=>{pe.queuePrompt(0)},redraw:()=>{pe.graph.setDirtyCanvas(!0,!1)},register:e=>{pe.registerExtension(e)},upload:async e=>await X.fetchApi("/upload/image",{method:"POST",body:e})},qo={getLatestRelease:async()=>{const e=S(),a="lf-nodes",t="lucafoscili",s={data:null,message:"",status:g.Info};try{const n=await fetch(`https://api.github.com/repos/${t}/${a}/releases/latest`);switch(n.status){case 200:const i=await n.json();s.data=i,s.message="Latest release successfully fetched from GitHub.",s.status=g.Success;break;case 404:s.message="No releases found for the repository!",s.status=g.Info;break;default:s.message="Unexpected response from the GitHub API!",s.status=g.Error;break}}catch(n){s.message=`Error fetching release info: ${n}`,s.status=g.Error}return e.log(s.message,{payload:s},s.status),s}},Yo={get:async e=>{const a=S(),t={data:{},message:"",status:g.Info};try{const s=new FormData;s.append("directory",e);const n=await X.fetchApi(N.GetImage,{body:s,method:"POST"});switch(n.status){case 200:const i=await n.json();i.status==="success"&&(t.data=i.data,t.message="Analytics data fetched successfully.",t.status=g.Success,a.log(t.message,{payload:t},t.status),a.getCachedDatasets().usage=t.data);break;default:t.message=`Unexpected response from the get-image API: ${n.text}`,t.status=g.Error;break}}catch(s){t.message=s,t.status=g.Error}return a.log(t.message,{payload:t},t.status),t},process:async(e,a,t)=>{const s=S(),n={data:"",message:"",status:g.Info};try{const r=new FormData;r.append("url",e),r.append("type",a),r.append("settings",JSON.stringify(t));const i=await X.fetchApi(N.ProcessImage,{body:r,method:"POST"});switch(i.status){case 200:const l=await i.json();l.status==="success"&&(n.data=l.data,n.message="Image processed successfully.",n.status=g.Success,s.log(n.message,{payload:n},n.status));break;default:n.message=`Unexpected response from the process-image API: ${i.text}`,n.status=g.Error;break}}catch(r){n.message=r,n.status=g.Error}return s.log(n.message,{payload:n},n.status),n}},Xo={get:async e=>{const a=S(),t={data:{},message:"",status:g.Info};try{const s=new FormData;s.append("file_path",e);const n=await X.fetchApi(N.GetJson,{body:s,method:"POST"});switch(n.status){case 200:const i=await n.json();i.status==="success"&&(t.data=i.data,t.message="JSON data fetched successfully.",t.status=g.Success,a.log(t.message,{payload:t},t.status),a.getCachedDatasets().usage=t.data);break;default:t.message=`Unexpected response from the get-json API: ${await n.text()}`,t.status=g.Error;break}}catch(s){t.message=s.toString(),t.status=g.Error}return a.log(t.message,{payload:t},t.status),t},update:async(e,a)=>{const t=S(),s={message:"",status:g.Info},n=new FormData;n.append("file_path",e),n.append("dataset",JSON.stringify(a));try{const r=await X.fetchApi(N.UpdateJson,{body:n,method:"POST"});switch(r.status){case 200:const o=await r.json();o.status==="success"&&(s.message=o.message,s.status=g.Success);break;default:s.message="Unexpected response from the API!",s.status=g.Error;break}}catch(r){s.message=r,s.status=g.Error}return t.log(s.message,{payload:s},s.status),s}},Ko={clear:async()=>{const e=S(),a={message:"",status:g.Info};try{const t=await X.fetchApi(N.ClearMetadata,{method:"POST"});switch(t.status){case 200:const n=await t.json();n.status==="success"&&(a.message=n.message,a.status=g.Success);break;default:a.message="Unexpected response from the API!",a.status=g.Error;break}}catch(t){a.message=t,a.status=g.Error}return e.log(a.message,{payload:a},a.status),a},get:async e=>{const a=S(),t={data:null,message:"",status:g.Info};try{const s=await fetch(`https://civitai.com/api/v1/model-versions/by-hash/${e}`);switch(s.status){case 200:const r=await s.json();t.data=r,t.message="Metadata succesfully fetched from CivitAI.",t.status=g.Success;break;case 404:t.message="Model not found on CivitAI!",t.status=g.Info;break;default:t.message="Unexpected response from the API!",t.status=g.Error;break}}catch(s){t.message=s,t.status=g.Error}return a.log(t.message,{payload:t},t.status),t},save:async(e,a,t=!1)=>{const s=S(),n={data:null,message:"",status:g.Info};try{const r=new FormData;r.append("model_path",e),r.append("metadata",JSON.stringify(a)),r.append("forced_save",String(t).valueOf());const i=await X.fetchApi(N.SaveMetadata,{method:"POST",body:r});switch(i.status){case 200:const l=await i.json();l.status==="success"&&(n.message=l.message,n.status=g.Success);break;default:n.message="Unexpected response from the API!",n.status=g.Error;break}}catch(r){n.message=r,n.status=g.Error}return s.log(n.message,{payload:n},n.status),n},updateCover:async(e,a)=>{const t=S(),s={message:"",status:g.Info};try{const n=new FormData;n.append("model_path",e),n.append("base64_image",a);const r=await X.fetchApi(N.UpdateMetadataCover,{method:"POST",body:n});switch(r.status){case 200:const o=await r.json();o.status==="success"&&(s.message=o.message,s.status=g.Success);break;default:s.message="Unexpected response from the API!",s.status=g.Error;break}}catch(n){s.message=n,s.status=g.Error}return t.log(s.message,{payload:s},s.status),s}};var we;(function(e){e.Content="lf-messenger",e.Widget="lf-messenger__widget",e.Placeholder="lf-messenger__placeholder",e.PlaceholderHidden="lf-messenger__placeholder--hidden"})(we||(we={}));var J;(function(e){e.boolean="BOOLEAN",e.combo="COMBO",e.customtext="CUSTOMTEXT",e.float="FLOAT",e.integer="INTEGER",e.json="JSON",e.number="NUMBER",e.seed="SEED",e.string="STRING",e.text="TEXT",e.toggle="TOGGLE"})(J||(J={}));var h;(function(e){e.card="LF_CARD",e.cardsWithChip="LF_CARDS_WITH_CHIP",e.carousel="LF_CAROUSEL",e.chat="LF_CHAT",e.chip="LF_CHIP",e.code="LF_CODE",e.compare="LF_COMPARE",e.controlPanel="LF_CONTROL_PANEL",e.countBarChart="LF_COUNT_BAR_CHART",e.history="LF_HISTORY",e.imageEditor="LF_IMAGE_EDITOR",e.masonry="LF_MASONRY",e.messenger="LF_MESSENGER",e.progressbar="LF_PROGRESSBAR",e.tabBarChart="LF_TAB_BAR_CHART",e.textarea="LF_TEXTAREA",e.tree="LF_TREE",e.upload="LF_UPLOAD"})(h||(h={}));var k;(function(e){e.blend="LF_Blend",e.blurImages="LF_BlurImages",e.boolean="LF_Boolean",e.brightness="LF_Brightness",e.brush="LF_Brush",e.characterImpersonator="LF_CharacterImpersonator",e.checkpointSelector="LF_CheckpointSelector",e.civitaiMetadataSetup="LF_CivitAIMetadataSetup",e.clarity="LF_Clarity",e.colorAnalysis="LF_ColorAnalysis",e.compareImages="LF_CompareImages",e.contrast="LF_Contrast",e.controlPanel="LF_ControlPanel",e.desaturation="LF_Desaturation",e.displayBoolean="LF_DisplayBoolean",e.displayFloat="LF_DisplayFloat",e.displayInteger="LF_DisplayInteger",e.displayJson="LF_DisplayJSON",e.displayPrimitiveAsJson="LF_DisplayPrimitiveAsJSON",e.displayString="LF_DisplayString",e.markdownDocGenerator="LF_MarkdownDocGenerator",e.filmGrain="LF_FilmGrain",e.float="LF_Float",e.embeddingSelector="LF_EmbeddingSelector",e.extractString="LF_ExtractString",e.extractPromptFromLoraTag="LF_ExtractPromptFromLoraTag",e.gaussianBlur="LF_GaussianBlur",e.getValueFromJson="LF_GetValueFromJSON",e.getRandomKeyFromJson="LF_GetRandomKeyFromJSON",e.imageClassifier="LF_ImageClassifier",e.imageListFromJSON="LF_ImageListFromJSON",e.imageHistogram="LF_ImageHistogram",e.imagesEditingBreakpoint="LF_ImagesEditingBreakpoint",e.imagesSlideshow="LF_ImagesSlideshow",e.integer="LF_Integer",e.isLandscape="LF_IsLandscape",e.keywordCounter="LF_KeywordCounter",e.keywordToggleFromJson="LF_KeywordToggleFromJSON",e.line="LF_Line",e.llmChat="LF_LLMChat",e.llmMessenger="LF_LLMMessenger",e.loadAndEditImages="LF_LoadAndEditImages",e.loadFileOnce="LF_LoadFileOnce",e.loadImages="LF_LoadImages",e.loadLoraTags="LF_LoadLoraTags",e.loadMetadata="LF_LoadMetadata",e.loraAndEmbeddingSelector="LF_LoraAndEmbeddingSelector",e.loraSelector="LF_LoraSelector",e.lutApplication="LF_LUTApplication",e.lutGeneration="LF_LUTGeneration",e.mathOperation="LF_MathOperation",e.multipleImageResizeForWeb="LF_MultipleImageResizeForWeb",e.notify="LF_Notify",e.parsePromptWithLoraTags="LF_ParsePromptWithLoraTags",e.randomBoolean="LF_RandomBoolean",e.regexReplace="LF_RegexReplace",e.regionExtractor="LF_RegionExtractor",e.resizeImageByEdge="LF_ResizeImageByEdge",e.resizeImageToDimension="LF_ResizeImageToDimension",e.resizeImageToSquare="LF_ResizeImageToSquare",e.resolutionSwitcher="LF_ResolutionSwitcher",e.samplerSelector="LF_SamplerSelector",e.saveImageForCivitai="LF_SaveImageForCivitAI",e.saveJson="LF_SaveJSON",e.saveMarkdown="LF_SaveMarkdown",e.schedulerSelector="LF_SchedulerSelector",e.sepia="LF_Sepia",e.sequentialSeedsGenerator="LF_SequentialSeedsGenerator",e.setValueInJson="LF_SetValueInJSON",e.shuffleJsonKeys="LF_ShuffleJSONKeys",e.something2Number="LF_Something2Number",e.something2String="LF_Something2String",e.sortJsonKeys="LF_SortJSONKeys",e.string="LF_String",e.stringReplace="LF_StringReplace",e.stringTemplate="LF_StringTemplate",e.stringToJson="LF_StringToJSON",e.switchFloat="LF_SwitchFloat",e.switchImage="LF_SwitchImage",e.switchInteger="LF_SwitchInteger",e.switchJson="LF_SwitchJSON",e.switchString="LF_SwitchString",e.updateUsageStatistics="LF_UpdateUsageStatistics",e.upscaleModelSelector="LF_UpscaleModelSelector",e.urandomSeedGenerator="LF_UrandomSeedGenerator",e.usageStatistics="LF_UsageStatistics",e.vaeSelector="LF_VAESelector",e.viewImages="LF_ViewImages",e.vignette="LF_Vignette",e.wallOfText="LF_WallOfText",e.writeJson="LF_WriteJSON"})(k||(k={}));var y;(function(e){e.Div="div",e.LfAccordion="lf-accordion",e.LfArticle="lf-article",e.LfButton="lf-button",e.LfCard="lf-card",e.LfCarousel="lf-carousel",e.LfChat="lf-chat",e.LfChart="lf-chart",e.LfChip="lf-chip",e.LfCode="lf-code",e.LfCompare="lf-compare",e.LfImageviewer="lf-imageviewer",e.LfList="lf-list",e.LfMasonry="lf-masonry",e.LfMessenger="lf-messenger",e.LfProgressbar="lf-progressbar",e.LfSlider="lf-slider",e.LfSpinner="lf-spinner",e.LfTabbar="lf-tabbar",e.LfTextfield="lf-textfield",e.LfToggle="lf-toggle",e.LfTree="lf-tree",e.LfUpload="lf-upload",e.Textarea="textarea"})(y||(y={}));const Zo={LF_Blend:[h.compare],LF_BlurImages:[h.masonry],LF_Boolean:[h.history],LF_Brightness:[h.compare],LF_Brush:[h.compare],LF_CharacterImpersonator:[h.code],LF_CheckpointSelector:[h.card],LF_CivitAIMetadataSetup:[h.code],LF_Clarity:[h.compare],LF_ColorAnalysis:[h.tabBarChart],LF_CompareImages:[h.compare],LF_Contrast:[h.compare],LF_ControlPanel:[h.controlPanel],LF_Desaturation:[h.compare],LF_DisplayBoolean:[h.code],LF_DisplayFloat:[h.code],LF_DisplayInteger:[h.code],LF_DisplayJSON:[h.code],LF_DisplayPrimitiveAsJSON:[h.code],LF_DisplayString:[h.code],LF_EmbeddingSelector:[h.card],LF_ExtractString:[h.code],LF_ExtractPromptFromLoraTag:[h.code],LF_FilmGrain:[h.compare],LF_Float:[h.history],LF_GaussianBlur:[h.compare],LF_GetRandomKeyFromJSON:[h.code],LF_GetValueFromJSON:[h.code],LF_ImageClassifier:[h.code],LF_ImageHistogram:[h.tabBarChart],LF_ImageListFromJSON:[h.masonry],LF_ImagesEditingBreakpoint:[h.imageEditor],LF_ImagesSlideshow:[h.carousel],LF_Integer:[h.history],LF_IsLandscape:[h.tree],LF_KeywordCounter:[h.countBarChart],LF_KeywordToggleFromJSON:[h.chip],LF_Line:[h.compare],LF_LLMChat:[h.chat],LF_LLMMessenger:[h.messenger],LF_LoadAndEditImages:[h.imageEditor],LF_LoadFileOnce:[h.history],LF_LoadImages:[h.masonry],LF_LoadLoraTags:[h.cardsWithChip],LF_LoadMetadata:[h.code,h.upload],LF_LoraAndEmbeddingSelector:[h.card],LF_LoraSelector:[h.card],LF_LUTApplication:[h.compare],LF_LUTGeneration:[h.tabBarChart],LF_MarkdownDocGenerator:[h.code],LF_MathOperation:[h.code],LF_MultipleImageResizeForWeb:[h.masonry],LF_Notify:[],LF_ParsePromptWithLoraTags:[h.code],LF_RandomBoolean:[h.progressbar],LF_RegexReplace:[h.code],LF_RegionExtractor:[h.code],LF_ResizeImageByEdge:[h.tree],LF_ResizeImageToDimension:[h.tree],LF_ResizeImageToSquare:[h.tree],LF_ResolutionSwitcher:[h.progressbar],LF_SamplerSelector:[h.history],LF_SaveImageForCivitAI:[h.masonry],LF_SaveJSON:[h.tree],LF_SaveMarkdown:[h.tree],LF_SchedulerSelector:[h.history],LF_Sepia:[h.compare],LF_SequentialSeedsGenerator:[h.history],LF_SetValueInJSON:[h.code],LF_ShuffleJSONKeys:[h.code],LF_Something2Number:[h.code],LF_Something2String:[h.code],LF_SortJSONKeys:[h.code],LF_String:[h.history],LF_StringReplace:[h.code],LF_StringTemplate:[h.code],LF_StringToJSON:[h.code],LF_SwitchFloat:[h.progressbar],LF_SwitchImage:[h.progressbar],LF_SwitchInteger:[h.progressbar],LF_SwitchJSON:[h.progressbar],LF_SwitchString:[h.progressbar],LF_UpdateUsageStatistics:[h.code],LF_UpscaleModelSelector:[h.history],LF_UsageStatistics:[h.tabBarChart],LF_UrandomSeedGenerator:[h.tree],LF_VAESelector:[h.history],LF_ViewImages:[h.masonry],LF_Vignette:[h.compare],LF_WallOfText:[h.code],LF_WriteJSON:[h.textarea]},Qo=async e=>{const a=e.prototype.onConnectionsChange;e.prototype.onConnectionsChange=function(){const t=a==null?void 0:a.apply(this,arguments),s=this;switch(s.comfyClass){case k.keywordToggleFromJson:ti(s);break;case k.llmMessenger:si(s);break}return t}},No=async e=>{const a=e.prototype.onDrawBackground;e.prototype.onDrawBackground=function(){const t=a==null?void 0:a.apply(this,arguments);return Mi(this),t}},ei=async e=>{const a=e.prototype.onNodeCreated;e.prototype.onNodeCreated=function(){var n;const t=a?a.apply(this,arguments):void 0,s=this;for(let r=0;r<((n=s.widgets)==null?void 0:n.length);r++){const i=s.widgets[r];switch(i.type.toUpperCase()){case h.imageEditor:const o=W().comfy.getDragAndScale();if(o){const l=o.onredraw;o.onredraw=function(){const c=l?l.apply(this,arguments):void 0,f=i.options.getState();return ai(f.elements.imageviewer),c}}break;case J.customtext:case J.string:case J.text:i.serializeValue=()=>{const l=W().comfy.comfyUi();return l.utils.applyTextReplacements(l,i.value)};break}}return t}},ti=e=>{var f,d,u;const a=S(),t=W().comfy,s=or(e,J.json),n=t.getLinkById((f=s==null?void 0:s.link)==null?void 0:f.toString()),r=t.getNodeById((d=n==null?void 0:n.origin_id)==null?void 0:d.toString());if(!s||!n||!r)return;const i=Ss(e,h.chip),o=(u=r==null?void 0:r.widgets)==null?void 0:u[n.origin_slot];if(!i||!o)return;const l=o.options.getValue(),c=i.options.getState().chip;try{const p=pt(l).parsedJson;dt(p)&&dt(c.lfDataset)?rr(p,c.lfDataset)||(c.lfDataset=p,a.log("Updated chip data",{dataset:l},g.Info)):dt(p)?(c.lfDataset=p,a.log("Set chip data",{dataset:l},g.Info)):a.log("Invalid JSON data",{dataset:l,error:"Invalid JSON"},g.Warning)}catch(p){a.log("Error processing chip data",{dataset:l,error:p},g.Error)}},si=e=>{var l,c,f,d,u,p,m;const a=or(e,J.json),t=W().comfy.getLinkById((l=a==null?void 0:a.link)==null?void 0:l.toString()),s=W().comfy.getNodeById((c=t==null?void 0:t.origin_id)==null?void 0:c.toString());if(!a||!t||!s)return;const n=Ss(e,h.messenger),r=(f=s==null?void 0:s.widgets)==null?void 0:f[t.origin_slot];if(!((d=r==null?void 0:r.options)!=null&&d.getValue))return;const i=r.options.getValue(),o=((u=n==null?void 0:n.options)==null?void 0:u.getState()).elements.messenger;try{const b=pt(i).parsedJson;dt(b)&&dt(o.lfDataset)?rr(b,o.lfDataset)||(o.lfDataset=b,o.reset(),S().log("Updated messenger data",{dataset:i},g.Info)):dt(b)?(o.lfDataset=b,o.reset(),S().log("Set messenger data",{dataset:i},g.Info)):S().log("Invalid JSON data",{dataset:i,error:"Invalid JSON"},g.Warning);const v=o.nextSibling||o.previousSibling;(m=(p=o.lfDataset)==null?void 0:p.nodes)!=null&&m[0]?v.classList.add(we.PlaceholderHidden):v.classList.remove(we.PlaceholderHidden)}catch(b){S().log("Error processing messenger data",{dataset:i,error:b},g.Error)}},ai=async e=>{requestAnimationFrame(async()=>{try{const{canvas:a}=(await e.getComponents()).details;a.resizeCanvas()}catch(a){S().log("Could't update canvas dimensions.",{error:a},g.Info)}})},ni=()=>({fontFamily:"var(--lf-font-family-monospace)",margin:"0",maxWidth:"100%",overflow:"hidden",padding:"4px 8px",textOverflow:"ellipsis"});var R;(function(e){e.LfAccordion="lf-accordion-event",e.LfArticle="lf-article-event",e.LfButton="lf-button-event",e.LfCanvas="lf-canvas-event",e.LfCard="lf-card-event",e.LfCarousel="lf-carousel-event",e.LfChat="lf-chat-event",e.LfChart="lf-chart-event",e.LfChip="lf-chip-event",e.LfCode="lf-code-event",e.LfCompare="lf-compare-event",e.LfImageviewer="lf-imageviewer-event",e.LfList="lf-list-event",e.LfManager="lf-manager-ready",e.LfMasonry="lf-masonry-event",e.LfMessenger="lf-messenger-event",e.LfProgressbar="lf-progressbar-event",e.LfSlider="lf-slider-event",e.LfSpinner="lf-spinner-event",e.LfTabbar="lf-tabbar-event",e.LfTextfield="lf-textfield-event",e.LfToggle="lf-toggle-event",e.LfTree="lf-tree-event",e.LfUpload="lf-upload-event",e.Textarea="textarea-event"})(R||(R={}));var B=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},ft=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},At,lt,is,Re,te,na,An,ss;class ri{constructor(){At.add(this),lt.set(this,{}),is.set(this,{wrapper:"lf-tooltip",content:"lf-tooltip__content"}),Re.set(this,void 0),te.set(this,void 0),ss.set(this,async(a,t)=>{const{eventType:s}=t.detail;switch(s){case"click":const n=S();switch(B(this,Re,"f")){case"upload":const r=await a.getValue(),i=new FileReader;i.onload=o=>{var f;const l=(f=o.target)==null?void 0:f.result;let c="";if(typeof l=="string")c=l.replace(/^data:.*,/,"");else if(l instanceof ArrayBuffer){const d=new Uint8Array(l);c=btoa(String.fromCharCode.apply(null,d))}B(this,lt,"f")&&(n.log("Invoking upload callback.",{base64String:c},g.Info),B(this,lt,"f")[B(this,Re,"f")](c))},i.readAsDataURL(r[0]);break}}})}create(a,t,s){const n=S().getManagers().lfFramework;B(this,te,"f")&&B(this,At,"m",na).call(this);const r=document.body;switch(ft(this,lt,s?{[t]:s}:{},"f"),ft(this,Re,t??"upload","f"),ft(this,te,document.createElement("div"),"f"),B(this,te,"f").classList.add(B(this,is,"f").wrapper),B(this,Re,"f")){case"upload":B(this,te,"f").appendChild(B(this,At,"m",An).call(this));break}n.portal.open(B(this,te,"f"),r,a,0,"auto"),n.addClickCallback({cb:()=>this.destroy(),element:B(this,te,"f")}),requestAnimationFrame(()=>r.appendChild(B(this,te,"f")))}destroy(){B(this,At,"m",na).call(this)}}lt=new WeakMap,is=new WeakMap,Re=new WeakMap,te=new WeakMap,ss=new WeakMap,At=new WeakSet,na=function(){var a;(a=B(this,te,"f"))==null||a.remove(),ft(this,te,null,"f"),ft(this,lt,{},"f"),ft(this,Re,null,"f")},An=function(){const a=document.createElement(y.Div),t=document.createElement(y.LfUpload),s=document.createElement(y.LfButton);return a.classList.add(B(this,is,"f").content),s.lfIcon="upload",s.lfLabel="Update cover",s.lfStretchX=!0,a.appendChild(t),a.appendChild(s),s.addEventListener(R.LfButton,B(this,ss,"f").bind(B(this,ss,"f"),t)),a};const oi={lfDataset:{nodes:[{cells:{lfImage:{shape:"image",value:"cloud_download"},lfText:{shape:"text",value:"Fetching metadata from CivitAI..."}},id:"0"}]}},ii=["lfDataset"],xn={button:(e,a)=>{const{comp:t,eventType:s}=a.detail,{grid:n,node:r}=e;switch(s){case"click":const i=Array.from(n.querySelectorAll(y.LfCard));if(i!=null&&i.length){const o=[],l=Ss(r,h.card);if(i.forEach(c=>{var d,u,p,m;const f=(m=(p=(u=(d=c.lfDataset)==null?void 0:d.nodes)==null?void 0:u[0])==null?void 0:p.cells)==null?void 0:m.lfCode;if(f){const{hash:b,path:v}=JSON.parse(JSON.stringify(f.value)),w=c.lfDataset;t.lfShowSpinner=!0,o.push({apiFlag:!0,dataset:w,hash:b,path:v})}}),o.length){const c={props:[]};In(l,i.length),Pn(o,!0).then(f=>{for(let d=0;d<f.length;d++){const u=f[d];u.lfDataset?c.props.push(u):c.props.push({...u,lfDataset:o[d].dataset})}l.options.setValue(JSON.stringify(c)),requestAnimationFrame(()=>t.lfShowSpinner=!1)})}}break}},card:e=>{var r,i;const{comp:a,eventType:t,originalEvent:s}=e.detail,n=(i=(r=a.lfDataset)==null?void 0:r.nodes)==null?void 0:i[0];switch(t){case"click":n!=null&&n.value&&window.open(String(n.value).valueOf(),"_blank");break;case"contextmenu":const o=s,l=S();o.preventDefault(),o.stopPropagation();const c=l.getManagers().tooltip,f=async d=>{var p,m,b,v;const u=(m=(p=a.lfDataset)==null?void 0:p.nodes)==null?void 0:m[0];if(u){const w=(b=u==null?void 0:u.cells)==null?void 0:b.lfCode;if(w)try{const _=JSON.parse(JSON.stringify(w.value)).path;l.log(`Updating cover for model with path: ${_}`,{b64image:d},g.Info),W().metadata.updateCover(_,d);const F=(v=u==null?void 0:u.cells)==null?void 0:v.lfImage;F&&(F.value=`data:image/png;charset=utf-8;base64,${d}`,a.refresh(),c.destroy())}catch{l.log("Failed to fetch the model's path from .info file",{b64image:d},g.Error)}}};c.create({x:o.x,y:o.y},"upload",f);break}}},In=(e,a)=>{const t={props:[]};for(let s=0;s<a;s++)t.props.push(oi);e.options.setValue(JSON.stringify(t))},Pn=async(e,a=!1)=>{const t=e.map(async({dataset:s,hash:n,path:r,apiFlag:i})=>{if(i){const o=await W().metadata.get(n);return Xa(s,r,a,o)}else return Xa(s,r,a,null)});return Promise.all(t)},Xa=async(e,a,t,s)=>{var o,l,c;const n=s==null?void 0:s.data,r=n==null?void 0:n.id,i={lfStyle:".sub-2.description { white-space: pre-wrap; }"};switch(typeof r){case"number":const f=(c=(l=(o=e==null?void 0:e.nodes)==null?void 0:o[0])==null?void 0:l.cells)==null?void 0:c.lfCode,d=ci(n,f);i.lfDataset=d,W().metadata.save(a,d,t);break;case"string":const u=e.nodes[0];u.description="",u.value="",u.cells.lfButton={lfIcon:"warning",lfLabel:"Not found on CivitAI!",lfStyling:"flat",lfUiState:"disabled",shape:"button",value:""},u.cells.text3={value:"Whoops! It seems like something's off. Falling back to local data."},i.lfDataset=e;break}return i},On=(e,a)=>{var n;let t=0;e.querySelectorAll("lf-card").forEach(r=>r.remove());for(let r=0;a&&r<a.length;r++){const i=e.appendChild(li());t+=1;const o=a[r];if(o.lfDataset){for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const c=o[l];if(l==="lfDataset")try{typeof c=="string"?i.lfDataset=pt(c).parsedJson:i.lfDataset=c;const f=(n=i.lfDataset.nodes)==null?void 0:n[0];f&&(i.dataset.link=f.description,f.value&&(i.title=String(f.value).valueOf()))}catch(f){S().log("Error when setting lfData prop on card!",{error:f},g.Error)}else i[l]=c}}}return t},Mn=e=>{const a=[],t=e.querySelectorAll("lf-card");for(let s=0;s<t.length;s++){const n=t[s],r=ii.reduce((i,o)=>(n[o]&&(i[o]=n[o]),i),{});a.push(r)}return a},li=()=>{const e=document.createElement(y.LfCard);return e.addEventListener(R.LfCard,xn.card),e},ci=(e,a)=>{var n,r,i,o,l;const t={nodes:[{cells:{lfCode:a??null,lfImage:null,text1:null,text2:null,text3:null},id:e.id.toString(),description:"Click to open the model's page on CivitAI",value:`https://civitai.com/models/${e.modelId}`}]},s=t.nodes[0].cells;return s.lfImage={shape:"image",value:e.images[0].url},s.text1={value:e.model.name},s.text2={value:e.name},s.text3={value:`- Info:
Type: ${(n=e.model)!=null&&n.type?e.model.type:"N/A"}
Status: ${e.status?e.status:"N/A"}
Base model: ${e.baseModel?e.baseModel:"N/A"}
Description: ${e.description?e.description:"N/A"}

- Trained words:
${(r=e.trainedWords)!=null&&r.length?e.trainedWords.join(", "):"N/A"}

- Stats:
Updated at: ${e.updatedAt?e.updatedAt:"N/A"}
Downloads: ${(i=e.stats)!=null&&i.downloadCount?e.stats.downloadCount:"N/A"}
Rating: ${(o=e.stats)!=null&&o.rating?e.stats.rating:"N/A"}
Thumbs up: ${(l=e.stats)!=null&&l.thumbsUpCount?e.stats.thumbsUpCount:"N/A"}

(data pulled from CivitAI at: ${new Date().toLocaleDateString()})
`},t};var Pt;(function(e){e.Content="lf-card",e.ContentHasButton="lf-card--has-button",e.Grid="lf-card__grid"})(Pt||(Pt={}));const je=new WeakMap,Rn={options:e=>({hideOnZoom:!1,getState:()=>je.get(e),getValue(){const{grid:a}=je.get(e);return{props:Mn(a)||[]}},setValue(a){const{grid:t}=je.get(e);G(a,(n,r)=>{const{props:i}=r.parsedJson,o=(i==null?void 0:i.length)>1?2:1;t.style.setProperty("--card-grid",`repeat(1, 1fr) / repeat(${o}, 1fr)`),On(t,i)},h.card)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.Div);switch(s.classList.add(Pt.Grid),t.classList.add(Pt.Content),t.appendChild(s),e.comfyClass){case k.checkpointSelector:case k.embeddingSelector:case k.loraAndEmbeddingSelector:case k.loraSelector:t.classList.add(Pt.ContentHasButton);const r=document.createElement(y.LfButton);r.lfIcon="cloud_download",r.lfLabel="Refresh",r.lfStretchX=!0,r.title="Attempts to manually ownload fresh metadata from CivitAI",r.addEventListener(R.LfButton,i=>xn.button(je.get(a),i)),t.appendChild(r);break}a.appendChild(t);const n=Rn.options(a);return je.set(a,{grid:s,node:e,wrapper:a}),{widget:z(h.card,a,e,n)}},state:je};var ct;(function(e){e.Content="lf-cardswithchip",e.Cards="lf-cardswithchip__cards",e.Chip="lf-cardswithchip__chip",e.Grid="lf-cardswithchip__grid"})(ct||(ct={}));const bt=new WeakMap,Wn={options:e=>({hideOnZoom:!1,getState:()=>bt.get(e),getValue(){const{chip:a,grid:t}=bt.get(e);return{chip:(a==null?void 0:a.lfDataset)||{},props:Mn(t)||[]}},setValue(a){const{chip:t,grid:s}=bt.get(e);G(a,(r,i)=>{const o=i.parsedJson,l=On(s,o.props);if(!l||!r)return;const c=l>1?2:1;s.style.setProperty("--card-grid",String(c).valueOf()),t&&(t.lfDataset=o.chip)},h.cardsWithChip)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.Div),n=document.createElement(y.Div),r=document.createElement(y.LfChip);t.classList.add(ct.Content),s.classList.add(ct.Grid),n.classList.add(ct.Cards),r.classList.add(ct.Chip),s.appendChild(r),s.appendChild(n),t.appendChild(s),a.appendChild(t);const i=Wn.options(a);return bt.set(a,{chip:r,grid:n,node:e,wrapper:a}),{widget:z(h.cardsWithChip,a,e,i)}},state:bt};var ls;(function(e){e.Content="lf-carousel",e.Widget="lf-carousel__widget"})(ls||(ls={}));const wt=new WeakMap,Bn={options:e=>({hideOnZoom:!0,getState:()=>wt.get(e),getValue(){const{carousel:a}=wt.get(e);return(a==null?void 0:a.lfDataset)||{}},setValue(a){const{carousel:t}=wt.get(e);G(a,(n,r)=>{const i=r.parsedJson;t.lfDataset=i||{}},h.carousel)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfCarousel);s.lfAutoPlay=!0,t.classList.add(ls.Content),s.classList.add(ls.Widget),t.appendChild(s),a.appendChild(t);const n=Bn.options(a);return wt.set(a,{carousel:s,node:e,wrapper:a}),{widget:z(h.carousel,a,e,n)}},state:wt},fi={chat:(e,a)=>{const{eventType:t,history:s,status:n}=a.detail;switch(t){case"polling":const r=n==="ready"?g.Info:n==="offline"?g.Error:g.Warning;S().log("Chat widget, polling status: "+n,{chat:a.detail},r);break;case"update":e.history=s;break}}};var cs;(function(e){e.Content="lf-chat",e.Widget="lf-chat__widget"})(cs||(cs={}));const He=new WeakMap,Vn={options:e=>({hideOnZoom:!1,getState:()=>He.get(e),getValue(){const{history:a}=He.get(e);return a||""},setValue(a){const t=He.get(e);G(a,n=>{t.history=n||"",t.chat.setHistory(n)},h.chat)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfChat);t.classList.add(cs.Content),s.classList.add(cs.Widget),s.addEventListener(R.LfChat,r=>fi.chat(He.get(a),r)),t.appendChild(s),a.appendChild(t);const n=Vn.options(a);return He.set(a,{chat:s,history:"",node:e,wrapper:a}),{widget:z(h.chat,a,e,n)}},state:He},di={chip:async(e,a)=>{const{comp:t,eventType:s}=a.detail;switch(s){case"click":const n=[];(await t.getSelectedNodes()).forEach(r=>{n.push(String(r.value).valueOf())}),e.selected=n.join(", ");break}}};var fs;(function(e){e.Content="lf-chip",e.Widget="lf-chip__widget"})(fs||(fs={}));const Je=new WeakMap,Un={options:e=>({hideOnZoom:!0,getState:()=>Je.get(e),getValue(){const{selected:a}=Je.get(e);return a||""},setValue(a){const t=Je.get(e);G(a,n=>{const r=n?n.split(", "):[];t.selected=n,t.chip.setSelectedNodes(r)},h.chip)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfChip);switch(t.classList.add(fs.Content),s.classList.add(fs.Widget),s.addEventListener(R.LfChip,r=>di.chip(Je.get(a),r)),e.comfyClass){case k.keywordToggleFromJson:s.lfStyling="filter";break}t.appendChild(s),a.appendChild(t);const n=Un.options(a);return Je.set(a,{chip:s,node:e,selected:"",wrapper:a}),{widget:z(h.chip,a,e,n)}},state:Je};var ds;(function(e){e.Content="lf-code",e.Widget="lf-code__widget"})(ds||(ds={}));const vt=new WeakMap,zn={options:e=>({hideOnZoom:!1,getState:()=>vt.get(e),getValue(){const{code:a}=vt.get(e);switch(a.lfLanguage){case"json":return a.lfValue||"{}";default:return a.lfValue||""}},setValue(a){const{code:t}=vt.get(e);G(a,(n,r)=>{switch(t.lfLanguage){case"json":t.lfValue=r.unescapedStr||"{}";break;default:t.lfValue=typeof n=="string"?n:"";break}},h.code)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfCode);switch(t.classList.add(ds.Content),s.classList.add(ds.Widget),e.comfyClass){case k.displayJson:case k.displayPrimitiveAsJson:case k.shuffleJsonKeys:case k.sortJsonKeys:case k.stringToJson:s.lfLanguage="json",s.lfValue="{}";break;default:s.lfLanguage="markdown",s.lfValue="";break}t.appendChild(s),a.appendChild(t);const n=zn.options(a);return vt.set(a,{code:s,node:e,wrapper:a}),{widget:z(h.code,a,e,n)}},state:vt};var us;(function(e){e.Content="lf-compare",e.Widget="lf-compare__widget"})(us||(us={}));const Lt=new WeakMap,Gn={options:e=>({hideOnZoom:!1,getState:()=>Lt.get(e),getValue(){const{compare:a}=Lt.get(e);return a.lfDataset||{}},setValue(a){const{compare:t}=Lt.get(e);G(a,(n,r)=>{t.lfDataset=r.parsedJson||{}},h.compare)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfCompare);switch(t.classList.add(us.Content),s.classList.add(us.Widget),e.comfyClass){default:s.lfShape="image";break}t.appendChild(s),a.appendChild(t);const n=Gn.options(a);return Lt.set(a,{compare:s,node:e,wrapper:a}),{widget:z(h.compare,a,e,n)}},state:Lt};var Mt;(function(e){e.Content="lf-controlpanel",e.Grid="lf-controlpanel__grid",e.Spinner="lf-controlpanel__spinner"})(Mt||(Mt={}));var De;(function(e){e.Analytics="pie_chart",e.Backup="save",e.Debug="bug",e.GitHub="github",e.Metadata="information-variant",e.Theme="style"})(De||(De={}));var fe;(function(e){e.Analytics="analytics",e.Backup="backup",e.Debug="debug",e.GitHub="github",e.Metadata="metadata",e.Theme="theme"})(fe||(fe={}));var M;(function(e){e.AutoBackup="Automatic Backup",e.Backup="Backup now",e.ClearLogs="Clear logs",e.Debug="Debug",e.DeleteUsage="Delete usage analytics info",e.DeleteMetadata="Delete models info",e.Done="Done!",e.OpenIssue="Open an issue",e.Theme="Random theme"})(M||(M={}));var $;(function(e){e.Content="content",e.ContentSeparator="content_spearator",e.Paragraph="paragraph",e.Root="root",e.Section="section"})($||($={}));const qe={customization:()=>({margin:"0"}),debugGrid:()=>({display:"grid",gridTemplateRows:"repeat(5, max-content) 1fr",height:"100%",margin:"0"}),debugLogs:()=>({display:"grid",gridGap:"12px",gridTemplateRows:"repeat(2, minmax(250px, 600px))"}),logsArea:()=>({backgroundColor:"rgba(var(--lf-text-color-rgb), 0.075)",borderRadius:"8px",display:"block",height:"100%",marginBottom:"16px",overflow:"auto"}),separator:()=>({border:"1px solid var(--lf-border-color)",display:"block",margin:"12px auto 24px",opacity:"0.25",width:"50%"})},Bt={[fe.Analytics]:()=>({icon:De.Analytics,id:$.Section,value:"Analytics",children:[{id:$.Paragraph,value:"Usage",children:[{id:$.Content,value:"Usage analytics can be enabled by saving datasets through the UpdateUsageStatistics node and displayed with the UsageStatistics node."},{id:$.Content,tagName:"br",value:""},{id:$.Content,value:"Once datasets are created (input folder of ComfyUI), the count for each resource used will increase everytime that particular resource is updated."},{id:$.Content,tagName:"br",value:""},{id:$.Content,value:"This button will clear all usage analytics data from your input folder."},{id:$.Content,tagName:"br",value:""},{id:$.Content,value:"This action is IRREVERSIBLE so use it with caution."},{id:$.Content,value:"",cells:{lfButton:{lfIcon:"delete",lfLabel:M.DeleteUsage,lfStyle:":host { margin: auto; padding:16px 0 }",lfStyling:"outlined",shape:"button",value:""}}}]}]}),[fe.Backup]:()=>({icon:De.Backup,id:$.Section,value:"Backup",children:[{id:$.Paragraph,value:"Toggle on/off",children:[{id:$.Content,value:"Toggle this toggle to automatically back up the folder <path/to/your/comfyui/user/LF_Nodes> once a day (the first time you open this workflow)."},{id:$.Content,tagName:"br",value:""},{id:$.Content,value:"",cells:{lfToggle:{lfLabel:M.AutoBackup,lfLeadingLabel:!0,lfStyle:":host { text-align: center; padding: 16px 0; }",shape:"toggle",value:!!S().isBackupEnabled()}}}]},{cssStyle:qe.separator(),id:$.ContentSeparator,value:""},{id:$.Paragraph,value:"Backup files",children:[{id:$.Content,value:"This button will create a manual backup of the content in <path/to/your/comfyui/user/LF_Nodes>"},{id:$.Content,value:"Be sure to include as much information as you can, without sufficient data it's difficult to troubleshoot problems."},{id:$.Content,value:"",cells:{lfButton:{lfIcon:"backup",lfLabel:M.Backup,lfStyle:":host { margin: auto; padding:16px 0 }",lfStyling:"raised",shape:"button",value:""}}}]}]}),[fe.Debug]:e=>({icon:De.Debug,id:$.Section,cssStyle:qe.debugGrid(),value:"Debug",children:[{id:$.Paragraph,value:"Toggle on/off",children:[{id:$.Content,value:"Activating the debug will enable the display of verbose logging."},{id:$.Content,value:"",cells:{lfToggle:{lfLabel:M.Debug,lfLeadingLabel:!0,lfStyle:":host { text-align: center; padding: 16px 0; }",shape:"toggle",value:!!S().isDebug()}}}]},{id:$.Paragraph,value:"Logs",children:[{id:$.Content,value:"Every time the node manager receives a messages, it will be printed below."},{id:$.Content,tagName:"br",value:""},{id:$.Content,value:"In the browser console there should be more informations."},{id:$.Content,tagName:"br",value:""},{id:$.Content,value:"Further below another widget will display additional Ketchup Lite components information."},{id:$.Content,value:"",cells:{lfButton:{htmlProps:{className:"lf-danger lf-full-width"},shape:"button",lfIcon:"refresh",lfLabel:M.ClearLogs,lfStyle:":host { padding-top: 16px; }",value:""}}}]},{id:$.Paragraph,cssStyle:qe.debugLogs(),value:"",children:[{id:"content-wrapper",cssStyle:qe.logsArea(),value:"",children:e},{cells:{lfCard:{lfDataset:{nodes:[{cells:{lfCode:{shape:"code",value:""},lfButton:{shape:"button",value:""},lfButton_2:{shape:"button",value:""},lfToggle:{shape:"toggle",value:!!S().getManagers().lfFramework.debug.isEnabled()}},id:"debug"}]},lfLayout:"debug",shape:"card",value:""}},id:"content-wrapper"}]}]}),[fe.GitHub]:()=>{var t,s;const a=S().getLatestRelease();return{icon:De.GitHub,id:$.Section,value:"",children:[{id:$.Paragraph,value:`Version: ${(a==null?void 0:a.tag_name)||"N/A"}`,children:[{cells:{lfCode:{lfLanguage:"markdown",shape:"code",value:(a==null?void 0:a.body)||"No changelog available"}},id:"release-description"},{id:"release-author",children:[{id:"author-avatar",value:"",cssStyle:{backgroundImage:`url(${((t=a==null?void 0:a.author)==null?void 0:t.avatar_url)||""})`,backgroundSize:"cover",borderRadius:"50%",display:"inline-block",height:"32px",marginRight:"0.5em",verticalAlign:"middle",width:"32px"}},{id:"author-name",value:`Author: ${((s=a==null?void 0:a.author)==null?void 0:s.login)||"Unknown"}`,cssStyle:{fontSize:"0.9em",color:"var(--lf-secondary-color)",verticalAlign:"middle"}}],cssStyle:{alignItems:"center",display:"flex",justifyContent:"center",marginBottom:"1em"}},{cssStyle:{color:"var(--lf-secondary-color)",display:"block",fontSize:"0.9em",fontStyle:"italic",marginBottom:"2em",textAlign:"center",width:"100%"},id:"release-date",value:`Published on: ${a!=null&&a.published_at?new Date(a.published_at).toLocaleDateString():"Unknown"}`},{cssStyle:qe.separator(),id:$.ContentSeparator,value:""},{id:$.Paragraph,value:"Bug report",children:[{id:$.Content,value:"If you find bugs or odd behaviors feel free to open an issue on GitHub, just follow the link below!"},{id:$.Content,tagName:"br",value:""},{id:$.Content,value:"Be sure to include as much information as you can, without sufficient data it's difficult to troubleshoot problems."},{id:$.Content,value:"",cells:{lfButton:{lfIcon:"github",lfLabel:M.OpenIssue,lfStyle:":host { margin: auto; padding:16px 0 }",lfStyling:"raised",shape:"button",value:""}}}]}]}]}},[fe.Metadata]:()=>({icon:De.Metadata,id:$.Section,value:"Metadata",children:[{id:$.Paragraph,value:"Purge metadata files",children:[{id:$.Content,value:"Metadata pulled from CivitAI are stored in .info files saved in the same folders of the models to avoid unnecessary fetches from the API."},{id:$.Content,value:"By pressing this button it's possible to delete every .info file created by fetching the metadata."},{id:$.Content,tagName:"br",value:""},{id:$.Content,value:"This action is IRREVERSIBLE so use it with caution."},{id:$.Content,value:"",cells:{lfButton:{lfIcon:"delete",lfLabel:M.DeleteMetadata,lfStyle:":host { margin: auto; padding:16px 0 }",lfStyling:"outlined",shape:"button",value:""}}}]}]}),[fe.Theme]:()=>({icon:De.Theme,id:$.Section,value:"Customization",cssStyle:qe.customization(),children:[{id:$.Paragraph,value:"Theme selector",children:[{id:$.Content,value:"Through the button below it's possible to set a random theme for the Ketchup Lite components, or select one from the dropdown menu."},{id:$.Content,value:"",cells:{lfButton:{lfDataset:Ii(),lfStyle:":host { margin: auto; padding: 16px 0 }",shape:"button",value:""}}}]}]})},Es=fe.GitHub;let Vt;const hs={article:e=>{const{eventType:a,originalEvent:t}=e.detail;switch(a){case"lf-event":hi(t);break}},button:e=>{const{comp:a,eventType:t,originalEvent:s}=e.detail,n=a.rootElement,r=()=>{const o=document.createElement("lf-spinner");return o.lfActive=!0,o.lfDimensions="0.6em",o.lfLayout=2,o.slot="spinner",o},i=(o,l)=>{const c=()=>{a.lfIcon="check",a.lfLabel=M.Done,a.lfShowSpinner=!1,a.lfUiState="disabled"},f=d=>{a.lfLabel=d,a.lfIcon="delete",a.lfUiState="primary",Vt=null};requestAnimationFrame(()=>a.lfShowSpinner=!0),o.then(()=>{requestAnimationFrame(c),Vt&&clearTimeout(Vt),Vt=setTimeout(()=>requestAnimationFrame(()=>f(l)),1e3)})};switch(t){case"click":switch(a.lfLabel){case M.Backup:i(W().backup.new("manual"),M.Backup);break;case M.ClearLogs:const{article:l,dataset:c}=S().getDebugDataset();(c==null?void 0:c.length)>0&&(c.splice(0,c.length),l.refresh());break;case M.DeleteMetadata:i(W().metadata.clear(),M.DeleteMetadata);break;case M.DeleteUsage:i(W().analytics.clear("usage"),M.DeleteUsage);break;case M.OpenIssue:window.open("https://github.com/lucafoscili/comfyui-lf/issues/new","_blank");break;case M.Theme:S().getManagers().lfFramework.theme.randomize();break}break;case"lf-event":const o=s;hs.list(o);break;case"ready":switch(a.lfLabel){case M.Backup:n.appendChild(r());break;case M.DeleteMetadata:case M.DeleteUsage:n.classList.add("lf-danger"),n.appendChild(r());break}}},list:e=>{const{comp:a,eventType:t,node:s}=e.detail,{lfFramework:n}=S().getManagers(),r=a.rootElement,i=s.id;switch(t){case"click":n.theme.set(i);break;case"ready":r.title="Change the LF Nodes suite theme",n.theme.set(i);break}},toggle:e=>{const{comp:a,eventType:t,value:s}=e.detail,n=a.rootElement;switch(t){case"change":S().toggleDebug(s==="on");break;case"ready":n.title="Activate verbose console logging"}}},ui=()=>{const e=document.createElement(y.Div),a=document.createElement(y.LfAccordion),t=[];a.lfDataset={nodes:t};for(const n in Bt)if(n!==Es&&Object.prototype.hasOwnProperty.call(Bt,n)){const r=Bt[n];let i,o;switch(n){case fe.Debug:const f=[];o=r(f),i=Cs(n,o),S().setDebugDataset(i,f);break;default:o=r(void 0),i=Cs(n,o);break}const{icon:l,value:c}=o;t.push({icon:l,id:n,value:c}),a.appendChild(i)}const s=Cs(Es,Bt[Es]());return e.classList.add(Mt.Grid),e.appendChild(s),e.appendChild(a),e},Cs=(e,a)=>{const t=document.createElement(y.LfArticle);return t.lfDataset={nodes:[{children:[a],id:$.Root}]},t.slot=e,t.addEventListener(R.LfArticle,hs.article),t},hi=e=>{const{comp:a}=e.detail;if(Di(a)){const t=e;hs.button(t)}if(xi(a)){const t=e;hs.toggle(t)}},Ts=new WeakMap,jn={options:e=>({hideOnZoom:!1,getState:()=>Ts.get(e),getValue(){return{backup:S().isBackupEnabled()||!1,debug:S().isDebug()||!1,themes:S().getManagers().lfFramework.theme.get.current().name||""}},setValue(a){G(a,(s,n)=>{const{backup:r,debug:i,themes:o}=n.parsedJson;return(r===!0||r===!1)&&S().toggleBackup(r),(i===!0||i===!1)&&S().toggleDebug(i),o&&S().getManagers().lfFramework.theme.set(o),a},h.controlPanel)}}),render:e=>{const a=(n,r)=>{const i=c=>{setTimeout(()=>{W().backup.new(),a(c,!0)},750)},o=()=>{const c=document.createElement(y.LfSpinner);return c.classList.add(Mt.Spinner),c.lfActive=!0,c.lfLayout=11,c},l=document.createElement(y.Div);if(r)l.appendChild(ui()),n.replaceChild(l,n.firstChild);else{const c=o();c.addEventListener(R.LfSpinner,i.bind(null,n)),l.appendChild(c),n.appendChild(l)}l.classList.add(Mt.Content)},t=document.createElement(y.Div);a(t,!1);const s=jn.options(t);return Ts.set(t,{node:e,wrapper:t}),{widget:z(h.controlPanel,t,e,s)}},state:Ts};var ps;(function(e){e.Content="lf-countbarchart",e.Widget="lf-countbarchart__widget"})(ps||(ps={}));const St=new WeakMap,Hn={options:e=>({hideOnZoom:!0,getState:()=>St.get(e),getValue(){const{datasets:a}=St.get(e);return{chart:(a==null?void 0:a.chart)||{},chip:(a==null?void 0:a.chip)||{}}},setValue(a){const{card:t,datasets:s}=St.get(e);G(a,(r,i)=>{const o=i.parsedJson;s.chart=o.chart||{},s.chip=o.chip||{},t.refresh()},h.countBarChart)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfCard),n={},r={};s.classList.add(ps.Widget),s.lfLayout="keywords",t.classList.add(ps.Content),t.appendChild(s),a.appendChild(t);const i=Hn.options(a);return St.set(a,{card:s,datasets:{chart:n,chip:r},node:e,wrapper:a}),{widget:z(h.countBarChart,a,e,i)}},state:St},pi={list:(e,a)=>{const{eventType:t,node:s}=a.detail,n=e.node,r=s?String(s.value).valueOf():"";if(t==="click"&&r){const i=ge(n,J.boolean),o=ge(n,J.combo),l=ge(n,J.customtext),c=ge(n,J.float),f=ge(n,J.integer),d=ge(n,J.number),u=ge(n,J.seed),p=ge(n,J.string),m=ge(n,J.toggle);switch(n.comfyClass){case k.boolean:i?i.value=String(s.value).toLowerCase()==="true":m&&(m.value=String(s.value).toLowerCase()==="true");break;case k.float:d?d.value=Number(s.value).valueOf():f&&(c.value=Number(s.value).valueOf());break;case k.integer:case k.sequentialSeedsGenerator:d?d.value=Number(s.value).valueOf():f?f.value=Number(s.value).valueOf():u&&(u.value=Number(s.value).valueOf());break;case k.samplerSelector:case k.schedulerSelector:case k.upscaleModelSelector:case k.vaeSelector:o.value=s.value;break;case k.string:p?p.options.setValue(s.value):l&&l.options.setValue(s.value);break}}}};var gs;(function(e){e.Content="lf-history",e.Widget="lf-history__widget"})(gs||(gs={}));const Ye=new WeakMap,Jn={options:e=>({hideOnZoom:!0,getState:()=>Ye.get(e),getValue(){const{list:a}=Ye.get(e);return(a==null?void 0:a.lfDataset)||{}},setValue(a){const{list:t}=Ye.get(e);G(a,(n,r)=>{t.lfDataset=r.parsedJson||{}},h.history)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfList);switch(s.classList.add(gs.Widget),s.lfEmpty="History is empty!",s.lfEnableDeletions=!0,e.comfyClass){case k.loadFileOnce:break;default:s.lfSelectable=!0;break}s.addEventListener(R.LfList,r=>pi.list(Ye.get(a),r)),t.classList.add(gs.Content),t.appendChild(s),a.appendChild(t);const n=Jn.options(a);return Ye.set(a,{list:s,node:e,wrapper:a}),{widget:z(h.history,a,e,n)}},state:Ye};var Q;(function(e){e.Content="lf-imageeditor",e.Widget="lf-imageeditor__widget",e.Actions="lf-imageeditor__actions",e.Grid="lf-imageeditor__grid",e.GridHasActions="lf-imageeditor__grid--has-actions",e.GridIsInactive="lf-imageeditor__grid--is-inactive",e.Settings="lf-imageeditor__settings",e.SettingsControls="lf-imageeditor__settings__controls"})(Q||(Q={}));var ue;(function(e){e.Completed="completed",e.Pending="pending"})(ue||(ue={}));var ms;(function(e){e.Path="path",e.Status="status"})(ms||(ms={}));var ut;(function(e){e.Interrupt="stop",e.Reset="refresh",e.Resume="play"})(ut||(ut={}));var L;(function(e){e.Canvas="canvas",e.Slider="slider",e.Textfield="textfield",e.Toggle="toggle"})(L||(L={}));var Ka;(function(e){e.B64Canvas="b64_canvas",e.Points="points"})(Ka||(Ka={}));var x;(function(e){e.BlueChannel="b_channel",e.BlurKernelSize="blur_kernel_size",e.BlurSigma="blur_sigma",e.Strength="strength",e.Gamma="gamma",e.GreenChannel="g_channel",e.Intensity="intensity",e.Midpoint="midpoint",e.Opacity="opacity",e.Radius="radius",e.RedChannel="r_channel",e.SharpenAmount="sharpen_amount",e.Size="size"})(x||(x={}));var We;(function(e){e.Color="color",e.Tint="tint"})(We||(We={}));var Be;(function(e){e.Localized="localized",e.Shape="shape",e.Smooth="smoooth",e.SoftBlend="soft_blend"})(Be||(Be={}));var ra;(function(e){e.Opacity="opacity"})(ra||(ra={}));var oa;(function(e){e.Strength="strength",e.Gamma="gamma",e.Midpoint="midpoint",e.Localized="localized"})(oa||(oa={}));var ia;(function(e){e.B64Canvas="b64_canvas",e.Color="color",e.Opacity="opacity",e.Size="size"})(ia||(ia={}));var la;(function(e){e.BlurKernelSize="blur_kernel_size",e.Strength="strength",e.SharpenAmount="sharpen_amount"})(la||(la={}));var ca;(function(e){e.Strength="strength",e.Localized="contrast",e.Midpoint="midpoint"})(ca||(ca={}));var fa;(function(e){e.RedChannel="r_channel",e.GreenChannel="g_channel",e.BlueChannel="b_channel",e.Strength="strength"})(fa||(fa={}));var da;(function(e){e.Intensity="intensity",e.Size="size",e.Tint="tint",e.SoftBlend="soft_blend"})(da||(da={}));var ua;(function(e){e.BlurKernelSize="blur_kernel_size",e.BlurSigma="blur_sigma"})(ua||(ua={}));var ha;(function(e){e.Color="color",e.Opacity="opacity",e.Points="points",e.Size="size",e.Smooth="smooth"})(ha||(ha={}));var pa;(function(e){e.Intensity="intensity"})(pa||(pa={}));var ga;(function(e){e.Color="color",e.Intensity="intensity",e.Radius="radius",e.Shape="shape"})(ga||(ga={}));const Z={blend:{controlIds:ra,settings:{color:"#FF0000",opacity:.5},configs:{[L.Slider]:[{ariaLabel:"Opacity",controlType:L.Slider,defaultValue:0,id:x.Opacity,isMandatory:!0,max:"1",min:"0",step:"0.01",title:"Adjust the opacity of the blended layer."}],[L.Textfield]:[{ariaLabel:"Color",controlType:L.Textfield,defaultValue:"#FF0000",id:We.Color,isMandatory:!0,title:"Sets the solid color that will be blended onto the image.",type:"color"}]}},brightness:{controlIds:oa,settings:{strength:0,gamma:0,localized:!1,midpoint:.5},configs:{[L.Slider]:[{ariaLabel:"Brightness Strength",controlType:L.Slider,defaultValue:0,id:x.Strength,isMandatory:!0,max:"1",min:"-1",step:"0.05",title:"Adjust the brightness of the image. Negative values darken, positive values brighten."},{ariaLabel:"Gamma",controlType:L.Slider,defaultValue:1,id:x.Gamma,max:"3",min:"0.1",step:"0.1",title:"Adjust the gamma correction. Values < 1 brighten shadows, > 1 darken highlights."},{ariaLabel:"Midpoint",controlType:L.Slider,defaultValue:.5,id:x.Midpoint,max:"1",min:"0",step:"0.05",title:"Defines the tonal midpoint for brightness scaling."}],[L.Toggle]:[{ariaLabel:"Localized Brightness",controlType:L.Toggle,defaultValue:!1,id:Be.Localized,off:"false",on:"true",title:"Enhance brightness locally in darker regions."}]}},brush:{controlIds:ia,hasCanvasAction:!0,settings:{b64_canvas:"",color:"#FF0000",opacity:1,size:10},configs:{[L.Slider]:[{ariaLabel:"Size",controlType:L.Slider,defaultValue:10,id:x.Size,isMandatory:!0,max:"500",min:"1",step:"1",title:"Sets the size of the brush."},{ariaLabel:"Opacity",controlType:L.Slider,defaultValue:1,id:x.Opacity,isMandatory:!0,max:"1",min:"0.05",step:"0.05",title:"Sets the opacity of the brush."}],[L.Textfield]:[{ariaLabel:"Color",controlType:L.Textfield,defaultValue:"#FF0000",id:We.Color,isMandatory:!0,title:"Sets the color of the brush stroke.",type:"color"}]}},clarity:{controlIds:la,settings:{strength:0,sharpen_amount:0,blur_kernel_size:1},configs:{[L.Slider]:[{ariaLabel:"Clarity Strength",controlType:L.Slider,defaultValue:0,id:x.Strength,isMandatory:!0,max:"5",min:"0",step:"0.1",title:"Controls the amount of contrast enhancement in midtones."},{ariaLabel:"Sharpen Amount",controlType:L.Slider,defaultValue:0,id:x.SharpenAmount,max:"5",min:"0",step:"0.1",title:"Controls how much sharpening is applied to the image."},{ariaLabel:"Blur Kernel Size",controlType:L.Slider,defaultValue:7,id:x.BlurKernelSize,max:"15",min:"1",step:"2",title:"Controls the size of the Gaussian blur kernel. Higher values mean more smoothing."}]}},contrast:{controlIds:ca,settings:{strength:0,localized:!1,midpoint:0},configs:{[L.Slider]:[{ariaLabel:"Contrast Strength",controlType:L.Slider,defaultValue:0,id:x.Strength,isMandatory:!0,max:"1",min:"-1",step:"0.05",title:"Controls the intensity of the contrast adjustment. 1.0 is no change, below 1 reduces contrast, above 1 increases contrast."},{ariaLabel:"Midpoint",controlType:L.Slider,defaultValue:.5,id:x.Midpoint,max:"1",min:"0",step:"0.05",title:"Defines the tonal midpoint for contrast scaling."}],[L.Toggle]:[{ariaLabel:"Localized Contrast",controlType:L.Toggle,defaultValue:!1,id:Be.Localized,off:"false",on:"true",title:"Apply contrast enhancement locally to edges and textures."}]}},desaturate:{controlIds:fa,settings:{r_channel:1,g_channel:1,b_channel:1,strength:0},configs:{slider:[{ariaLabel:"Desaturation strength",controlType:L.Slider,defaultValue:0,id:x.Strength,isMandatory:!0,max:"1",min:"0",step:"0.05",title:"Controls the total intensity of the desaturation. 0 is no effect, 1 is fully desaturated."},{ariaLabel:"Red channel level",controlType:L.Slider,defaultValue:1,id:x.RedChannel,max:"1",min:"0",step:"0.05",title:"Controls the intensity of the red channel desaturation relative to the total strength of the filter."},{ariaLabel:"Green channel level",controlType:L.Slider,defaultValue:1,id:x.GreenChannel,max:"1",min:"0",step:"0.05",title:"Controls the intensity of the green channel desaturation relative to the total strength of the filter."},{ariaLabel:"Blue channel level",controlType:L.Slider,defaultValue:1,id:x.BlueChannel,max:"1",min:"0",step:"0.05",title:"Controls the intensity of the blue channel desaturation relative to the total strength of the filter."}]}},filmGrain:{controlIds:da,settings:{intensity:0,size:1,soft_blend:!1,tint:"#FFFFFF"},configs:{[L.Slider]:[{ariaLabel:"Intensity",controlType:L.Slider,defaultValue:0,id:x.Intensity,isMandatory:!0,max:"1",min:"0",step:"0.05",title:"Sets the strength of the filter."},{ariaLabel:"Size",controlType:L.Slider,defaultValue:1,id:x.Size,isMandatory:!0,max:"5",min:"0.5",step:"0.1",title:"Sets the size of the noise's granularity."}],[L.Textfield]:[{ariaLabel:"Tint",controlType:L.Textfield,defaultValue:"#FFFFFF",id:We.Tint,isMandatory:!0,title:"Hexadecimal color (default is FFFFFF for no tint).",type:"color"}],[L.Toggle]:[{ariaLabel:"Soft blend",controlType:L.Toggle,defaultValue:!1,id:Be.SoftBlend,title:"If True, uses a soft blending mode for the grain.",off:"false",on:"true"}]}},gaussianBlur:{controlIds:ua,settings:{blur_kernel_size:1,blur_sigma:0},configs:{[L.Slider]:[{ariaLabel:"Blur Sigma",controlType:L.Slider,defaultValue:0,id:x.BlurSigma,max:"10",min:"0.1",step:"0.1",title:"Standard deviation for the Gaussian kernel. Controls blur intensity."},{ariaLabel:"Blur Kernel Size",controlType:L.Slider,defaultValue:7,id:x.BlurKernelSize,max:"51",min:"1",step:"2",title:"Controls the size of the Gaussian blur kernel. Higher values mean more smoothing."}]}},line:{controlIds:ha,hasCanvasAction:!0,settings:{color:"#FF0000",opacity:1,points:[],size:10,smooth:!1},configs:{[L.Canvas]:[],[L.Slider]:[{ariaLabel:"Size",controlType:L.Slider,defaultValue:10,id:x.Size,isMandatory:!0,max:"500",min:"1",step:"1",title:"Sets the size of the brush."},{ariaLabel:"Opacity",controlType:L.Slider,defaultValue:1,id:x.Opacity,isMandatory:!0,max:"1",min:"0.05",step:"0.05",title:"Sets the opacity of the brush."}],[L.Textfield]:[{ariaLabel:"Color",controlType:L.Textfield,defaultValue:"#FF0000",id:We.Color,isMandatory:!0,title:"Sets the color of the brush stroke.",type:"color"}],[L.Toggle]:[{ariaLabel:"Smooth",controlType:L.Toggle,defaultValue:!1,id:Be.Smooth,title:"Draws a smooth line.",off:"false",on:"true"}]}},sepia:{controlIds:pa,settings:{intensity:0},configs:{[L.Slider]:[{ariaLabel:"Sepia Intensity",controlType:L.Slider,defaultValue:0,id:x.Intensity,isMandatory:!0,max:"1",min:"0",step:"0.01",title:"Controls the intensity of the sepia effect."}]}},vignette:{controlIds:ga,settings:{intensity:0,radius:0,shape:!1,color:"000000"},configs:{[L.Slider]:[{ariaLabel:"Vignette Intensity",controlType:L.Slider,defaultValue:0,id:x.Intensity,isMandatory:!0,max:"1",min:"0",step:"0.05",title:"Controls the darkness of the vignette effect. Higher values mean darker edges."},{ariaLabel:"Vignette Radius",controlType:L.Slider,defaultValue:0,id:x.Radius,isMandatory:!0,max:"1",min:"0",step:"0.05",title:"Controls the size of the vignette effect. Lower values mean a smaller vignette."}],[L.Textfield]:[{ariaLabel:"Color",controlType:L.Textfield,defaultValue:"000000",id:We.Color,title:"Sets the color of the vignette.",type:"color"}],[L.Toggle]:[{ariaLabel:"Circular",controlType:L.Toggle,defaultValue:!1,id:Be.Shape,off:"elliptical",on:"circular",title:"Selects the shape of the vignette effect, defaults to elliptical."}]}}},gi={nodes:[{description:"Tool configuration.",id:"settings",icon:"wrench",value:"Settings",children:[{description:"Brush configuration.",cells:{kulCode:{shape:"code",value:JSON.stringify(Z.brush)}},id:"brush",value:"Brush"}]},{description:"Basic adjustments such as sharpening and color tuning.",id:"basic_adjustments",value:"Basic Adjustments",icon:"settings",children:[{description:"Adjusts the brightness.",cells:{kulCode:{shape:"code",value:JSON.stringify(Z.brightness)}},id:"brightness",value:"Brightness"},{description:"Simulates the Lightroom clarity effect.",cells:{kulCode:{shape:"code",value:JSON.stringify(Z.clarity)}},id:"clarity",value:"Clarity"},{description:"Adjusts the contrast.",cells:{kulCode:{shape:"code",value:JSON.stringify(Z.contrast)}},id:"contrast",value:"Contrast"},{description:"Reduces the saturation.",cells:{kulCode:{shape:"code",value:JSON.stringify(Z.desaturate)}},id:"desaturate",value:"Desaturate"}]},{description:"Artistic filters, such as vignette effect and gaussian blur.",id:"creative_effects",icon:"palette",value:"Creative Effects",children:[{cells:{kulCode:{shape:"code",value:JSON.stringify(Z.blend)}},description:"Blends a color layer onto the image.",id:"blend",value:"Blend"},{description:"Applies a film grain effect.",cells:{kulCode:{shape:"code",value:JSON.stringify(Z.filmGrain)}},id:"film_grain",value:"Film grain"},{description:"Blurs the image.",cells:{kulCode:{shape:"code",value:JSON.stringify(Z.gaussianBlur)}},id:"gaussian_blur",value:"Gaussian blur"},{description:"Draws a line.",cells:{kulCode:{shape:"code",value:JSON.stringify(Z.line)}},id:"line",value:"Line"},{cells:{kulCode:{shape:"code",value:JSON.stringify(Z.sepia)}},description:"Applies a sepia effect to the image.",id:"sepia",value:"Sepia"},{cells:{kulCode:{shape:"code",value:JSON.stringify(Z.vignette)}},description:"Applies a vignetting effect to the image.",id:"vignette",value:"Vignette"}]}]},Ue={button:async(e,a)=>{const{comp:t,eventType:s}=a.detail,{elements:n}=e,{actionButtons:r,grid:i,imageviewer:o}=n;if(s==="click"){const l=async()=>{const c=o.lfDataset,f=Si(c),d=qn(c);if((d==null?void 0:d.title)===ue.Pending){d.title=ue.Completed;const u=pt(f).parsedJson.title;await W().json.update(u,c),ma(ue.Completed,i,r);const{masonry:p}=(await o.getComponents()).navigation;await o.reset(),await p.setSelectedShape(null)}};switch(t.lfIcon){case ut.Interrupt:W().comfy.interrupt();break}await l(),Yn(o)}},canvas:async(e,a)=>{const{comp:t,eventType:s,points:n}=a.detail,{filter:r,filterType:i}=e;switch(s){case"stroke":const o=r,l=i;let c="";if(i==="brush"||!(r!=null&&r.hasCanvasAction)){e.filterType="brush";const d=await t.getCanvas();c=Oi(d)}const f={...JSON.parse(JSON.stringify(Z.brush)),settings:{b64_canvas:c,color:t.lfColor,opacity:t.lfOpacity,points:n,size:t.lfSize}};e.filter=f;try{await ya(e,!0)}finally{e.filter=o,e.filterType=l,await t.clearCanvas()}break}},imageviewer:async(e,a)=>{var i;const{comp:t,eventType:s,originalEvent:n}=a.detail,{node:r}=e;switch(s){case"lf-event":const o=n;switch(o.detail.eventType){case"click":if(Ai(o.detail.comp)){const{node:d}=o.detail;(i=d.cells)!=null&&i.lfCode&&bi(e,d)}break;case"stroke":const f=o;Ue.canvas(e,f);break}break;case"ready":const{details:l,navigation:c}=await t.getComponents();switch(r.comfyClass){case k.imagesEditingBreakpoint:c.load.lfLabel="",c.load.lfUiState="disabled",c.textfield.lfLabel="Previews are visible in your ComfyUI/temp folder",c.textfield.lfUiState="disabled";break;default:c.textfield.lfLabel="Directory (relative to ComfyUI/input)";break}break}},slider:async(e,a)=>{const{eventType:t}=a.detail,{update:s}=e,{preview:n,snapshot:r}=s;switch(t){case"change":r();break;case"input":an(n,300)();break}},textfield:async(e,a)=>{const{eventType:t}=a.detail,{update:s}=e,{preview:n,snapshot:r}=s;switch(t){case"change":r();break;case"input":an(n,300)();break}},toggle:async(e,a)=>{const{eventType:t}=a.detail,{update:s}=e,{snapshot:n}=s;switch(t){case"change":n();break}}},mi=async(e,a)=>{const{elements:t,filter:s,filterType:n}=e,{imageviewer:r}=t,i=S(),o=(await r.getCurrentSnapshot()).value;requestAnimationFrame(()=>r.setSpinnerStatus(!0));try{const l=await W().image.process(o,n,s.settings);if(l.status==="success")if(a)r.addSnapshot(l.data);else{const{canvas:c}=(await r.getComponents()).details,f=await c.getImage();requestAnimationFrame(()=>f.lfValue=l.data)}else i.log("Error processing image!",{response:l},g.Error)}catch(l){i.log("Error processing image!",{error:l},g.Error)}requestAnimationFrame(()=>r.setSpinnerStatus(!1))},yi=async(e,a=!1)=>{const{elements:t,filter:s}=e,{controls:n}=t,r=S();for(const i in n)if(Object.prototype.hasOwnProperty.call(n,i)){const o=i,l=n[o];switch(l.tagName){case"LF-SLIDER":{const f=await l.getValue();s.settings[o]=a?f.real:f.display;break}case"LF-TEXTFIELD":{const f=await l.getValue();s.settings[o]=f;break}case"LF-TOGGLE":{const c=l,f=await c.getValue();s.settings[o]=f==="on"?c.dataset.on:c.dataset.off;break}default:r.log(`Unhandled control type: ${l.tagName}`,{control:l},g.Warning);continue}}},bi=(e,a)=>{e.elements.controls={},e.filter=pt(a.cells.lfCode.value).parsedJson,e.filterType=a.id;const{elements:t,filter:s}=e,{settings:n}=t;n.innerHTML="";const r=document.createElement(y.Div);r.classList.add(Q.SettingsControls),n.appendChild(r),Object.keys(s.configs).forEach(l=>{const c=s.configs[l];c&&c.forEach(f=>{switch(l){case L.Slider:const d=wi(e,f);r.appendChild(d),e.elements.controls[f.id]=d;break;case L.Textfield:const u=vi(e,f);r.appendChild(u),e.elements.controls[f.id]=u;break;case L.Toggle:const p=Li(e,f);r.appendChild(p),e.elements.controls[f.id]=p;break;default:throw new Error(`Unknown control type: ${l}`)}})});const o=document.createElement(y.LfButton);o.classList.add("lf-full-width"),o.lfIcon=ut.Reset,o.lfLabel="Reset",o.addEventListener("click",()=>Yn(n)),n.appendChild(o)},wi=(e,a)=>{const t=document.createElement(y.LfSlider);return t.lfLabel=Ta(a),t.lfLeadingLabel=!0,t.lfMax=Number(a.max),t.lfMin=Number(a.min),t.lfStep=Number(a.step),t.lfStyle=".form-field { width: 100%; }",t.lfValue=Number(a.defaultValue),t.title=a.title,t.addEventListener(R.LfSlider,s=>Ue.slider(e,s)),t},vi=(e,a)=>{const t=document.createElement(y.LfTextfield);return t.lfLabel=Ta(a),t.lfHtmlAttributes={type:a.type},t.lfValue=String(a.defaultValue).valueOf(),t.title=a.title,t.addEventListener(R.LfTextfield,s=>Ue.textfield(e,s)),t},Li=(e,a)=>{const t=document.createElement(y.LfToggle);return t.dataset.off=a.off,t.dataset.on=a.on,t.lfLabel=Ta(a),t.lfValue=!1,t.title=a.title,t.addEventListener(R.LfToggle,s=>Ue.toggle(e,s)),t},Si=e=>{var a;return((a=e==null?void 0:e.columns)==null?void 0:a.find(t=>t.id===ms.Path))||null},qn=e=>{var a;return((a=e==null?void 0:e.columns)==null?void 0:a.find(t=>t.id===ms.Status))||null},Ta=e=>e.isMandatory?`${e.ariaLabel}*`:e.ariaLabel,Yn=async e=>{const a=Array.from(e.querySelectorAll("[data-id]"));for(const t of a)switch(t.tagName){case"LF-SLIDER":const s=t;await s.setValue(s.lfValue),await s.refresh();break;case"LF-TEXTFIELD":const n=t;await n.setValue(n.lfValue);break;case"LF-TOGGLE":const r=t;r.setValue(r.lfValue?"on":"off");break}},ma=(e,a,t)=>{switch(e){case ue.Completed:requestAnimationFrame(()=>{t.interrupt.lfUiState="disabled",t.resume.lfUiState="disabled"}),a.classList.add(Q.GridIsInactive);break;case ue.Pending:requestAnimationFrame(()=>{t.interrupt.lfUiState="primary",t.resume.lfUiState="primary"}),a.classList.remove(Q.GridIsInactive);break}},ya=async(e,a=!1)=>{await yi(e,a);const{elements:t,filter:s}=e,{imageviewer:n}=t,{settings:r}=s,i=ir(r),o=r.points||r.b64_canvas,l=!s||s.hasCanvasAction;if(i&&l){const{color:f,size:d,opacity:u}=r,p=(await n.getComponents()).details.canvas;p.lfColor=f,p.lfOpacity=u,p.lfSize=d}!!(i&&(!l||l&&o))&&mi(e,a)},re=new WeakMap,Xn={options:e=>({hideOnZoom:!1,getState:()=>re.get(e),getValue:()=>{const{imageviewer:a}=re.get(e).elements;return a.lfDataset||{}},setValue:a=>{const{actionButtons:t,grid:s,imageviewer:n}=re.get(e).elements;G(a,(i,o)=>{var f;const l=o.parsedJson;((f=qn(l))==null?void 0:f.title)===ue.Pending&&ma(ue.Pending,s,t),n.lfDataset=l||{}},h.imageEditor)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.Div),n=document.createElement(y.Div),r=document.createElement(y.LfImageviewer),i=async c=>{S().getApiRoutes().image.get(c).then(f=>{f.status==="success"&&(f!=null&&f.data&&Object.entries(f.data).length>0?r.lfDataset=f.data:S().log("Images not found.",{r:f},g.Info))})};n.classList.add(Q.Settings),n.slot="settings",r.classList.add(Q.Widget),r.lfLoadCallback=async(c,f)=>await i(f),r.lfValue=gi,r.addEventListener(R.LfImageviewer,c=>Ue.imageviewer(re.get(a),c)),r.appendChild(n);const o={};switch(e.comfyClass){case k.imagesEditingBreakpoint:const c=document.createElement(y.Div),f=document.createElement(y.LfButton),d=document.createElement(y.LfButton);f.lfIcon=ut.Interrupt,f.lfLabel="Interrupt workflow",f.lfStretchX=!0,f.lfUiState="danger",f.title="Click to interrupt the workflow.",f.addEventListener(R.LfButton,u=>Ue.button(re.get(a),u)),d.lfIcon=ut.Resume,d.lfLabel="Resume workflow",d.lfStretchX=!0,d.lfStyling="flat",d.lfUiState="success",d.title="Click to resume the workflow. Remember to save your snapshots after editing the images!",d.addEventListener(R.LfButton,u=>Ue.button(re.get(a),u)),c.classList.add(Q.Actions),c.appendChild(f),c.appendChild(d),s.classList.add(Q.GridIsInactive),s.classList.add(Q.GridHasActions),s.appendChild(c),o.interrupt=f,o.resume=d,ma(ue.Completed,s,o)}s.classList.add(Q.Grid),s.appendChild(r),t.classList.add(Q.Content),t.appendChild(s),a.appendChild(t);const l=Xn.options(a);return re.set(a,{elements:{actionButtons:o,controls:{},grid:s,imageviewer:r,settings:n},filter:null,filterType:null,node:e,update:{preview:()=>ya(re.get(a)),snapshot:()=>ya(re.get(a),!0)},wrapper:a}),{widget:z(h.imageEditor,a,e,l)}},state:re},Za={masonry:(e,a)=>{var r,i;const{eventType:t,originalEvent:s,selectedShape:n}=a.detail;switch(t){case"lf-event":const{eventType:o}=s.detail;switch(o){case"click":const l=((r=n.shape)==null?void 0:r.value)||((i=n.shape)==null?void 0:i.lfValue);e.selected.index=n.index,e.selected.name=l?String(l).valueOf():"";break}break}}};var ys;(function(e){e.Content="lf-masonry",e.Widget="lf-masonry__widget"})(ys||(ys={}));const Xe=new WeakMap,Kn={options:e=>({hideOnZoom:!1,getState:()=>Xe.get(e),getValue(){const{masonry:a,selected:t}=Xe.get(e),{index:s,name:n}=t;return{columns:(a==null?void 0:a.lfColumns)||3,dataset:(a==null?void 0:a.lfDataset)||{},index:sn(s)?s:NaN,name:n||"",view:(a==null?void 0:a.lfView)||"main"}},setValue(a){G(a,(s,n)=>{const{masonry:r,selected:i}=Xe.get(e),{columns:o,dataset:l,index:c,name:f,view:d}=n.parsedJson;o&&(r.lfColumns=o),l&&(r.lfDataset=l||{}),d&&(r.lfView=d),sn(c)&&(i.index=c,i.name=f||"",r.setSelectedShape(c))},h.masonry)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfMasonry);switch(s.classList.add(ys.Widget),s.addEventListener(R.LfMasonry,Za.masonry.bind(Za.masonry,Xe.get(a))),e.comfyClass){case k.loadImages:s.lfSelectable=!0;break}t.classList.add(ys.Content),t.appendChild(s),a.appendChild(t);const n=Kn.options(a);return Xe.set(a,{masonry:s,node:e,selected:{index:NaN,name:""},wrapper:a}),{widget:z(h.masonry,a,e,n)}},state:Xe},$i=`The setup of this node must be done client-side. Use either <strong>LF_WriteJSON</strong> or <strong>LF_DisplayJSON</strong>
to connect as input a valid JSON dataset. Check the repository's workflows to see a 
<a target="_blank" href="https://github.com/lucafoscili/comfyui-lf/blob/fd52deb44d199e222833fbc159628aceeac48ab9/workflows/LLMMessenger.png">working example here.</a>.`,_i={messenger:(e,a)=>{const{eventType:t,config:s}=a.detail;switch(t){case"save":s&&typeof s=="object"&&(e.config=s);break}}},Ke=new WeakMap,Zn={options:e=>({hideOnZoom:!1,getState:()=>Ke.get(e),getValue(){const{config:a,elements:t}=Ke.get(e),{messenger:s}=t;return{dataset:s.lfDataset||{},config:a}},setValue(a){const t=Ke.get(e),{elements:s}=t,{messenger:n,placeholder:r}=s,i=(l,c)=>{const{config:f,dataset:d}=c.parsedJson;n.lfDataset=d,ir(f)&&(n.lfValue=f,t.config=f),r.classList.add(we.PlaceholderHidden)},o=()=>{r.classList.remove(we.PlaceholderHidden)};G(a,i,h.messenger,o)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.Div),n=document.createElement(y.LfMessenger);t.classList.add(we.Content),n.classList.add(we.Widget),s.classList.add(we.Placeholder),s.innerHTML=$i,n.addEventListener(R.LfMessenger,i=>_i.messenger(Ke.get(a),i)),t.appendChild(s),t.appendChild(n),a.appendChild(t);const r=Zn.options(a);return Ke.set(a,{config:null,elements:{messenger:n,placeholder:s},node:e,wrapper:a}),{widget:z(h.messenger,a,e,r)}},state:Ke};var ba;(function(e){e.Content="lf-progressbar"})(ba||(ba={}));var bs;(function(e){e.Landscape="landscape",e.Portrait="portrait"})(bs||(bs={}));var Ve;(function(e){e.Fallback="N/A",e.False="false",e.True="true"})(Ve||(Ve={}));const $t=new WeakMap,Qn={options:e=>({hideOnZoom:!1,getState:()=>$t.get(e),getValue(){const{progressbar:a}=$t.get(e);return{bool:a.lfLabel==="true",roll:a.lfValue||0}},setValue(a){const{node:t,progressbar:s}=$t.get(e);G(a,(r,i)=>{const{bool:o,roll:l}=i.parsedJson,c=o===!1,f=o===!0;switch(t.comfyClass){case k.resolutionSwitcher:f?s.lfIcon=bs.Landscape:c?s.lfIcon=bs.Portrait:s.lfLabel=Ve.Fallback;break;default:f?(s.lfUiState="success",s.lfLabel=Ve.True):c?(s.lfUiState="danger",s.lfLabel=Ve.False):(s.lfUiState="primary",s.lfLabel=Ve.Fallback);break}s.title=l?"Actual roll: "+l.toString():"",s.lfValue=l||100},h.progressbar)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfProgressbar);s.lfIsRadial=!0,s.lfLabel=Ve.Fallback,t.classList.add(ba.Content),t.appendChild(s),a.appendChild(t);const n=Qn.options(a);return $t.set(a,{node:e,progressbar:s,wrapper:a}),{widget:z(h.progressbar,a,e,n)}},state:$t},Qa={tabbar:(e,a)=>{const{eventType:t,node:s}=a.detail,{elements:n}=e,{chart:r}=n;switch(t){case"click":switch(e.node.comfyClass){case k.usageStatistics:r.lfDataset=S().getCachedDatasets().usage[s.id];break;default:r.lfDataset=s.cells.lfChart.lfDataset;break}break}},textfield:(e,a)=>{const{eventType:t,value:s}=a.detail;switch(t){case"change":e.directory=s,Nn(e);break}}},Nn=async e=>{const{directory:a,elements:t,selected:s,type:n}=e,{chart:r,tabbar:i,textfield:o}=t;W().analytics.get(a,n).then(l=>{if(l.status==="success")if(l!=null&&l.data&&Object.entries(l.data).length>0){const c=s||Object.keys(l.data)[0];r.lfDataset=l.data[c],i.lfDataset=er(l.data),requestAnimationFrame(async()=>{a!==await o.getValue()&&o.setValue(a),i.setValue(0)})}else S().log("Analytics not found.",{r:l},g.Info)})},er=e=>{var t;const a={nodes:[]};for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const n={cells:{lfChart:{lfDataset:e[s],shape:"chart",value:""}},id:s,value:((t=s.split("_"))==null?void 0:t[0])||s};a.nodes.push(n)}return a};var ce;(function(e){e.Content="lf-tabbarchart",e.Directory="lf-tabbarchart__directory",e.DirectoryHidden="lf-tabbarchart__directory--hidden",e.Grid="lf-tabbarchart__grid",e.GridNoDirectory="lf-tabbarchart__grid--no-directory",e.Spinner="lf-tabbarchart__spinner",e.Tabbar="lf-tabbarchart__tabbar"})(ce||(ce={}));var Ot;(function(e){e.Blue="blue",e.Green="green",e.Red="red"})(Ot||(Ot={}));var H;(function(e){e.Blue="blue",e.Counter="counter",e.Green="green",e.Intensity="intensity",e.Name="name",e.Red="red"})(H||(H={}));const Ie=new WeakMap,tr={options:e=>({hideOnZoom:!1,getState:()=>Ie.get(e),getValue:()=>{const{directory:a,node:t}=Ie.get(e);switch(t.comfyClass){case k.usageStatistics:return{directory:a||""};default:return{}}},setValue:a=>{const t=Ie.get(e),{chart:s,tabbar:n}=t.elements;G(a,(i,o)=>{const l=o.parsedJson;switch(t.node.comfyClass){case k.usageStatistics:t.directory=l.directory,Nn(t);break;default:for(const c in l){const f=l[c];s.lfDataset=f||{},n.lfDataset=er(l)||{},requestAnimationFrame(async()=>n.setValue(0))}break}},h.tabBarChart)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.Div),n=document.createElement(y.LfTextfield),r=document.createElement(y.LfChart),i=document.createElement(y.LfTabbar);let o;switch(e.comfyClass){case k.colorAnalysis:r.lfAxis=[H.Intensity],r.lfColors=[Ot.Red,Ot.Green,Ot.Blue],r.lfSeries=[H.Red,H.Green,H.Blue],r.lfTypes=["scatter"],s.classList.add(ce.GridNoDirectory),n.classList.add(ce.DirectoryHidden);break;case k.imageHistogram:case k.lutGeneration:r.lfAxis=[H.Intensity],r.lfColors=[H.Red,H.Green,H.Blue],r.lfSeries=[H.Red,H.Green,H.Blue],r.lfTypes=["area"],s.classList.add(ce.GridNoDirectory),n.classList.add(ce.DirectoryHidden);break;case k.usageStatistics:o="usage",r.lfAxis=[H.Name],r.lfSeries=[H.Counter,H.Counter],r.lfTypes=["area"];break}i.classList.add(ce.Tabbar),i.lfValue=null,i.addEventListener(R.LfTabbar,c=>Qa.tabbar(Ie.get(a),c)),n.classList.add(ce.Directory),n.lfIcon="folder",n.lfLabel="Directory",n.lfStyling="flat",n.addEventListener(R.LfTextfield,c=>Qa.textfield(Ie.get(a),c)),s.classList.add(ce.Grid),s.appendChild(n),s.appendChild(i),s.appendChild(r),t.classList.add(ce.Content),t.appendChild(s),a.appendChild(t);const l=tr.options(a);return Ie.set(a,{directory:"",elements:{chart:r,tabbar:i,textfield:n},node:e,selected:"",type:o,wrapper:a}),{widget:z(h.tabBarChart,a,e,l)}},state:Ie};var ht;(function(e){e.Content="lf-textarea",e.Widget="lf-textarea__widget",e.WidgetError="lf-textarea__widget--error"})(ht||(ht={}));let Na;const ki={input:e=>{const a=e.currentTarget,t=()=>{Na=setTimeout(async()=>{try{const n=JSON.parse(a.value),r=JSON.stringify(n,null,2);r!=="{}"&&(a.title="",a.value=r,a.classList.remove(ht.WidgetError))}catch(n){S().log("Error parsing JSON",{error:n},g.Warning),a.classList.add(ht.WidgetError),a.title=n}},2500)};clearTimeout(Na),t()}},_t=new WeakMap,sr={options:e=>({hideOnZoom:!1,getState:()=>_t.get(e),getValue(){const{textarea:a}=_t.get(e);try{return(a==null?void 0:a.value)||"{}"}catch(t){return t}},setValue(a){const{textarea:t}=_t.get(e);G(a,(n,r)=>{const i=r.parsedJson;t.value=JSON.stringify(i,null,2)||"{}"},h.textarea)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.Textarea);t.classList.add(ht.Content),t.appendChild(s),s.classList.add(ht.Widget),s.addEventListener("input",ki.input),a.appendChild(t);const n=sr.options(a);return _t.set(a,{node:e,textarea:s,wrapper:a}),{widget:z(h.textarea,a,e,n)}},state:_t};var ws;(function(e){e.Content="lf-tree",e.Widget="lf-tree__widget"})(ws||(ws={}));const kt=new WeakMap,ar={options:e=>({hideOnZoom:!0,getState:()=>kt.get(e),getValue(){const{tree:a}=kt.get(e);return a.lfDataset||{}},setValue(a){const{tree:t}=kt.get(e);G(a,(n,r)=>{t.lfDataset=r.parsedJson||{}},h.tree)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfTree);switch(e.comfyClass){case k.isLandscape:s.lfAccordionLayout=!1,s.lfSelectable=!1;break;default:s.lfAccordionLayout=!0,s.lfSelectable=!1;break}s.classList.add(ws.Widget),t.classList.add(ws.Content),t.appendChild(s),a.appendChild(t);const n=ar.options(a);return kt.set(a,{node:e,tree:s,wrapper:a}),{widget:z(h.tree,a,e,n)}},state:kt},Ei={upload:async(e,a)=>{var r;const{eventType:t,selectedFiles:s}=a.detail,{upload:n}=e;switch(t){case"delete":e.files=Array.from(s,o=>o.name).join(";")||"";return;case"upload":const i=new Set;for(let o=0;o<s.length;o++){const l=s[o];try{const c=new FormData,f=l.webkitRelativePath.lastIndexOf("/"),d=l.webkitRelativePath.slice(0,f+1),u=new File([l],l.name,{type:l.type,lastModified:l.lastModified});c.append("image",u),f>0&&c.append("subfolder",d);const p=await W().comfy.upload(c);p.status===200||p.status===201?(S().log("POST result",{json:p.json},g.Success),i.add(l.name),n.dataset.files=n.dataset.files+";"+l.name):S().log("POST failed",{statusText:p.statusText},g.Error)}catch(c){alert(`Upload failed: ${c}`)}}e.files=((r=Array.from(i))==null?void 0:r.join(";"))||"";break}}};var vs;(function(e){e.Content="lf-upload",e.Widget="lf-upload__widget"})(vs||(vs={}));const Ze=new WeakMap,nr={options:e=>({hideOnZoom:!0,getState:()=>Ze.get(e),getValue(){const{files:a}=Ze.get(e);return a||""},setValue(a){const t=Ze.get(e);G(a,n=>{t.files=n},h.upload)}}),render:e=>{const a=document.createElement(y.Div),t=document.createElement(y.Div),s=document.createElement(y.LfUpload);s.classList.add(vs.Widget),s.addEventListener(R.LfUpload,r=>Ei.upload(Ze.get(a),r)),t.classList.add(vs.Content),t.appendChild(s),a.appendChild(t);const n=nr.options(a);return Ze.set(a,{files:"",node:e,upload:s,wrapper:a}),{widget:z(h.upload,a,e,n)}},state:Ze};var Ut=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},wa,xt;class Ci{constructor(){wa.set(this,{[h.card]:Rn,[h.carousel]:Bn,[h.cardsWithChip]:Wn,[h.chat]:Vn,[h.chip]:Un,[h.code]:zn,[h.compare]:Gn,[h.controlPanel]:jn,[h.countBarChart]:Hn,[h.history]:Jn,[h.imageEditor]:Xn,[h.masonry]:Kn,[h.messenger]:Zn,[h.progressbar]:Qn,[h.tabBarChart]:tr,[h.textarea]:sr,[h.tree]:ar,[h.upload]:nr}),this.render=a=>Ut(this,wa,"f")[a].render,this.decorators={card:(a,t)=>{const{apiFlags:s,datasets:n,hashes:r,paths:i,chip:o}=a;In(t,1);const l={props:[],chip:o},c=[];for(let f=0;f<(n==null?void 0:n.length);f++){const d=s[f],u=n[f],p=r[f],m=i[f];c.push({dataset:u,hash:p,path:m,apiFlag:d})}Pn(c).then(f=>{for(let d=0;d<f.length;d++){const u=f[d];u.lfDataset?l.props.push(u):l.props.push({...u,lfDataset:c[d].dataset})}t.options.setValue(JSON.stringify(l)),W().comfy.redraw()})}},this.onEvent=(a,t,s)=>{const n=S(),r=t.detail,i=n.getApiRoutes().comfy.getNodeById(r.id);if(i){switch(n.log(`${i.comfyClass} (#${i.id}): event '${a}' fired`,{payload:r,node:i},g.Info),a){case k.notify:"action"in r&&Ut(this,xt,"f").show(r);break}for(let o=0;o<s.length;o++){const l=s[o],c=Ss(i,l);switch(l){case h.imageEditor:switch(a){case k.imagesEditingBreakpoint:if(c&&"value"in r){const{value:f}=r;n.log(`Initiating JSON data fetch for editing breakpoint from path: ${f}`,{widget:c,value:f}),W().json.get(f).then(d=>{d.status===g.Success?(n.log("JSON data fetched successfully for image editing breakpoint.",{data:d.data},g.Success),c.options.setValue(JSON.stringify(d.data))):n.log(`Failed to fetch JSON data: ${d.message}`,{response:d},g.Error)}).catch(d=>{n.log(`Error during JSON fetch for editing breakpoint: ${d.toString()}`,{error:d},g.Error)})}else n.log("Image editor widget handling failed: missing 'widget' or 'value' in payload.",{widget:c,payload:r},g.Warning);break;default:if(c&&"dataset"in r){const{dataset:f}=r;c.options.setValue(JSON.stringify(f))}break}break;case h.card:case h.cardsWithChip:c&&"apiFlags"in r&&this.decorators.card(r,c);break;case h.code:case h.upload:if(c&&"value"in r){const{value:f}=r;c.options.setValue(f)}break;case h.masonry:case h.progressbar:c&&c.options.setValue(JSON.stringify(r));break;case h.countBarChart:case h.tabBarChart:if(c&&"datasets"in r){const{datasets:f}=r;c.options.setValue(JSON.stringify(f))}break;default:if(c&&"dataset"in r){const{dataset:f}=r;c.options.setValue(JSON.stringify(f))}break}}n.getApiRoutes().comfy.redraw()}else n.log(`Event '${a}' was fired but its related node (#${r.id}) wasn't found in the graph! Skipping handling the event.`,{payload:r,name:a},g.Warning)},xt.set(this,{decorate:a=>{const{action:t,image:s,message:n,silent:r,tag:i,title:o}=a,l=t==="focus tab"?"visibility":t==="interrupt"?"not_interested":t==="interrupt and queue"?"refresh":t==="queue prompt"?"queue":"",c={body:n,icon:l?window.location.href+`extensions/comfyui-lf/assets/svg/${l}.svg`:void 0,requireInteraction:t!=="none",silent:r,tag:i};"image"in Notification.prototype&&s&&(c.image=s),Notification.permission==="granted"&&new Notification(o,c).addEventListener("click",()=>{const d=S(),u=W().comfy;switch(t){case"focus tab":window.focus();break;case"interrupt":u.interrupt();break;case"interrupt and queue":u.interrupt(),u.queuePrompt(),d.log("New prompt queued from notification after interrupting.",{},g.Success);break;case"queue prompt":u.queuePrompt(),d.log("New prompt queued from notification.",{},g.Success);break}})},show:a=>{const t=S();Notification.permission!=="granted"?Notification.requestPermission().then(s=>{s==="granted"?Ut(this,xt,"f").decorate(a):t.log("Notification permission denied.",{},g.Warning)}):Ut(this,xt,"f").decorate(a)}})}}wa=new WeakMap,xt=new WeakMap;var A=function(e,a,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?e!==a||!s:!a.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:a.get(e)},Le=function(e,a,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?e!==a||!n:!a.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,t):n?n.value=t:a.set(e,t),t},at,nt,va,ee,rt,ot,as,ns,le;class Ti{constructor(){at.set(this,{analytics:jo,backup:Ho,comfy:Jo,github:qo,image:Yo,json:Xo,metadata:Ko}),nt.set(this,!0),va.set(this,{usage:null}),ee.set(this,!1),rt.set(this,void 0),ot.set(this,void 0),as.set(this,!1),ns.set(this,void 0),le.set(this,{});const a=window.location.href+"extensions/lf-nodes/assets";A(this,le,"f").lfFramework=hn(),A(this,le,"f").lfFramework.assets.set(a),this.log("LfFramework ready!",{lfFramework:A(this,le,"f").lfFramework},g.Success);const t=document.createElement("link");t.dataset.filename="_index",t.rel="stylesheet",t.type="text/css",t.href="extensions/lf-nodes/css/_index.css",document.head.appendChild(t),A(this,le,"f").tooltip=new ri,A(this,le,"f").widgets=new Ci}initialize(){if(A(this,at,"f").github.getLatestRelease().then(a=>Le(this,ns,(a==null?void 0:a.data)||null,"f")),A(this,as,"f")){this.log("Attempt to initialize LFManager when already ready!",{LFManager:this},g.Warning);return}for(const a in k)if(Object.prototype.hasOwnProperty.call(k,a)){const t=k[a],s=this.getEventName(t),n=Zo[t],r={},i=[];(n.includes(h.countBarChart)||n.includes(h.tabBarChart))&&i.push(No),(n.includes(h.chip)||n.includes(h.messenger))&&i.push(Qo),i.push(ei);const o={name:"LFExt_"+t,async beforeRegisterNodeDef(l){l.comfyClass===t&&i.forEach(c=>c(l))},getCustomWidgets:()=>n.reduce((l,c)=>({...l,[c]:A(this,le,"f").widgets.render(c)}),r)};A(this,at,"f").comfy.register(o),A(this,at,"f").comfy.event(s,l=>{A(this,le,"f").widgets.onEvent(t,l,n)})}Le(this,as,!0,"f")}getApiRoutes(){return A(this,at,"f")}getCachedDatasets(){return A(this,va,"f")}getDebugDataset(){return{article:A(this,rt,"f"),dataset:A(this,ot,"f")}}getEventName(a){return a.toLowerCase().replace("_","-")}getLatestRelease(){return A(this,ns,"f")}getManagers(){return A(this,le,"f")}isBackupEnabled(){return A(this,nt,"f")}isDebug(){return A(this,ee,"f")}log(a,t,s=g.Info){var c;if(!A(this,ee,"f"))return;let n="";switch(s){case"success":n="\x1B[32m";break;case"warning":n="\x1B[33m";break;case"error":n="\x1B[31m";break;default:n="\x1B[0m";break}const r="\x1B[3m",i="\x1B[1m",o="\x1B[0m",l="â€¢ LF Nodes â€¢";if(A(this,ot,"f")&&((c=A(this,rt,"f"))!=null&&c.isConnected)&&s!==g.Info){const f=String(performance.now()).valueOf(),d=s===g.Error?"ðŸ”´ ":s===g.Success?"ðŸŸ¢ ":s===g.Warning?"ðŸŸ  ":"ðŸ”µ ";A(this,ot,"f").unshift({cssStyle:ni(),id:f,tagName:"pre",value:d+a}),A(this,rt,"f").refresh()}console.log(`${n}${i}${l}${o}${r} ${a} ${o}`,t)}setDebugDataset(a,t){Le(this,rt,a,"f"),Le(this,ot,t,"f")}toggleBackup(a){return a===!1||a===!0?Le(this,nt,a,"f"):Le(this,nt,!A(this,nt,"f"),"f"),this.log(`Automatic backup active: '${A(this,ee,"f")}'`,{value:a},g.Warning),A(this,ee,"f")}toggleDebug(a){return a===!1||a===!0?Le(this,ee,a,"f"):Le(this,ee,!A(this,ee,"f"),"f"),this.log(`Debug active: '${A(this,ee,"f")}'`,{value:a},g.Warning),A(this,ee,"f")}}at=new WeakMap,nt=new WeakMap,va=new WeakMap,ee=new WeakMap,rt=new WeakMap,ot=new WeakMap,as=new WeakMap,ns=new WeakMap,le=new WeakMap;const Fi="__LfManager__",La=Symbol.for(Fi),en="ui_widget";let tn;const Di=e=>e.rootElement.tagName.toLowerCase()==="lf-button",Ai=e=>e.rootElement.tagName.toLowerCase()==="lf-tree",xi=e=>e.rootElement.tagName.toLowerCase()==="lf-toggle",rr=(e,a)=>JSON.stringify(e)===JSON.stringify(a),dt=e=>{try{return JSON.stringify(e),!0}catch{return!1}},pt=e=>{let a=!1,t,s=e;const n=i=>{let o=i.replace(/\\(.)/g,"$1");for(;o!==i;)i=o,o=i.replace(/\\(.)/g,"$1");return o},r=i=>{if(typeof i=="string")try{const o=JSON.parse(i);if(typeof o=="object"&&o!==null)return r(o)}catch{return i}else typeof i=="object"&&i!==null&&Object.keys(i).forEach(o=>{i[o]=r(i[o])});return i};try{t=JSON.parse(e),a=!0,t=r(t),s=JSON.stringify(t,null,2)}catch{if(typeof e=="object"&&e!==null)try{s=JSON.stringify(e,null,2),a=!0,t=e}catch{s=n(e.toString())}else s=n(e.toString())}return{validJson:a,parsedJson:t,unescapedStr:s}},W=()=>S().getApiRoutes(),S=()=>window[La],Ii=()=>S().getManagers().lfFramework.theme.get.themes().asDataset,Pi=()=>{window[La]||(window[La]=new Ti)},or=(e,a)=>{var t;return(t=e==null?void 0:e.inputs)==null?void 0:t.find(s=>s.type.toLowerCase()===a.toLowerCase())},sn=e=>!isNaN(e)&&typeof e=="number",Oi=e=>e.toDataURL("image/png"),z=(e,a,t,s)=>{S().log(`Creating '${e}'`,{element:a});try{const{nodeData:n}=Object.getPrototypeOf(t).constructor;let r=en;for(const i in n.input)if(Object.prototype.hasOwnProperty.call(n.input,i)){const o=n.input[i];for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)&&Array.from(o[l])[0]===e){r=l;break}if(r)break}return t.addDOMWidget(r,e,a,s)}catch(n){return S().log(`Couldn't find a widget of type ${e}`,{error:n,node:t},g.Warning),t.addDOMWidget(en,e,a,s)}},an=(e,a)=>(...t)=>{clearTimeout(tn),tn=setTimeout(()=>e(...t),a)},nn=(e,a)=>{var t;return(t=e==null?void 0:e.widgets)==null?void 0:t.find(s=>s.type===a)},Ss=(e,a)=>{var t;return(t=e==null?void 0:e.widgets)==null?void 0:t.find(s=>s.type.toLowerCase()===a.toLowerCase())},ge=(e,a)=>{var t;return(t=e==null?void 0:e.widgets)==null?void 0:t.find(s=>s.type.toLowerCase()===a.toLowerCase())},ir=e=>e&&typeof e=="object"&&Object.keys(e).length>0,G=(e,a,t,s)=>{try{a(e,pt(e))}catch(n){s&&s(),S().log("Normalization error!",{error:n,widget:t},g.Error)}},Mi=e=>{var a,t;try{const s=((a=nn(e,h.countBarChart))==null?void 0:a.element)||((t=nn(e,h.tabBarChart))==null?void 0:t.element);if(s){const n=s.querySelector("lf-chart");if(n){const r=n.shadowRoot.querySelector("canvas"),i=(r==null?void 0:r.clientWidth)<n.clientWidth||(r==null?void 0:r.clientHeight)<n.clientHeight,o=(r==null?void 0:r.clientWidth)>n.clientWidth||(r==null?void 0:r.clientHeight)>n.clientHeight;(i||o)&&n.refresh()}}}catch(s){S().log("Whoops! It seems there is no chart. :V",{error:s},g.Error)}};hn();Pi();const Ri=S();Ri.initialize();Go();
